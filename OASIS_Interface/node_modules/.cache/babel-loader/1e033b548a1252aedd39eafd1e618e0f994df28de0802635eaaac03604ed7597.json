{"ast":null,"code":"import { multiaddr } from '@multiformats/multiaddr';\nimport { CircuitRelay } from '../pb/index.js';\n/**\n * Write a response\n */\nfunction writeResponse(streamHandler, status) {\n  streamHandler.write({\n    type: CircuitRelay.Type.STATUS,\n    code: status\n  });\n}\n/**\n * Validate incomming HOP/STOP message\n */\nexport function validateAddrs(msg, streamHandler) {\n  try {\n    if (msg.dstPeer?.addrs != null) {\n      msg.dstPeer.addrs.forEach(addr => {\n        return multiaddr(addr);\n      });\n    }\n  } catch (err) {\n    writeResponse(streamHandler, msg.type === CircuitRelay.Type.HOP ? CircuitRelay.Status.HOP_DST_MULTIADDR_INVALID : CircuitRelay.Status.STOP_DST_MULTIADDR_INVALID);\n    throw err;\n  }\n  try {\n    if (msg.srcPeer?.addrs != null) {\n      msg.srcPeer.addrs.forEach(addr => {\n        return multiaddr(addr);\n      });\n    }\n  } catch (err) {\n    writeResponse(streamHandler, msg.type === CircuitRelay.Type.HOP ? CircuitRelay.Status.HOP_SRC_MULTIADDR_INVALID : CircuitRelay.Status.STOP_SRC_MULTIADDR_INVALID);\n    throw err;\n  }\n}","map":{"version":3,"names":["multiaddr","CircuitRelay","writeResponse","streamHandler","status","write","type","Type","STATUS","code","validateAddrs","msg","dstPeer","addrs","forEach","addr","err","HOP","Status","HOP_DST_MULTIADDR_INVALID","STOP_DST_MULTIADDR_INVALID","srcPeer","HOP_SRC_MULTIADDR_INVALID","STOP_SRC_MULTIADDR_INVALID"],"sources":["../../../../src/circuit/circuit/utils.ts"],"sourcesContent":[null],"mappings":"AAAA,SAASA,SAAS,QAAQ,yBAAyB;AACnD,SAASC,YAAY,QAAQ,gBAAgB;AAG7C;;;AAGA,SAASC,aAAaA,CAAEC,aAA4B,EAAEC,MAA2B;EAC/ED,aAAa,CAACE,KAAK,CAAC;IAClBC,IAAI,EAAEL,YAAY,CAACM,IAAI,CAACC,MAAM;IAC9BC,IAAI,EAAEL;GACP,CAAC;AACJ;AAEA;;;AAGA,OAAM,SAAUM,aAAaA,CAAEC,GAAiB,EAAER,aAA4B;EAC5E,IAAI;IACF,IAAIQ,GAAG,CAACC,OAAO,EAAEC,KAAK,IAAI,IAAI,EAAE;MAC9BF,GAAG,CAACC,OAAO,CAACC,KAAK,CAACC,OAAO,CAAEC,IAAI,IAAI;QACjC,OAAOf,SAAS,CAACe,IAAI,CAAC;MACxB,CAAC,CAAC;;GAEL,CAAC,OAAOC,GAAQ,EAAE;IACjBd,aAAa,CAACC,aAAa,EAAEQ,GAAG,CAACL,IAAI,KAAKL,YAAY,CAACM,IAAI,CAACU,GAAG,GAC3DhB,YAAY,CAACiB,MAAM,CAACC,yBAAyB,GAC7ClB,YAAY,CAACiB,MAAM,CAACE,0BAA0B,CAAC;IACnD,MAAMJ,GAAG;;EAGX,IAAI;IACF,IAAIL,GAAG,CAACU,OAAO,EAAER,KAAK,IAAI,IAAI,EAAE;MAC9BF,GAAG,CAACU,OAAO,CAACR,KAAK,CAACC,OAAO,CAAEC,IAAI,IAAI;QACjC,OAAOf,SAAS,CAACe,IAAI,CAAC;MACxB,CAAC,CAAC;;GAEL,CAAC,OAAOC,GAAQ,EAAE;IACjBd,aAAa,CAACC,aAAa,EAAEQ,GAAG,CAACL,IAAI,KAAKL,YAAY,CAACM,IAAI,CAACU,GAAG,GAC3DhB,YAAY,CAACiB,MAAM,CAACI,yBAAyB,GAC7CrB,YAAY,CAACiB,MAAM,CAACK,0BAA0B,CAAC;IACnD,MAAMP,GAAG;;AAEb"},"metadata":{},"sourceType":"module","externalDependencies":[]}