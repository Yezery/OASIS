{"ast":null,"code":"module.exports = class RateLimiterAbstract {\n  /**\n   *\n   * @param opts Object Defaults {\n   *   points: 4, // Number of points\n   *   duration: 1, // Per seconds\n   *   blockDuration: 0, // Block if consumed more than points in current duration for blockDuration seconds\n   *   execEvenly: false, // Execute allowed actions evenly over duration\n   *   execEvenlyMinDelayMs: duration * 1000 / points, // ms, works with execEvenly=true option\n   *   keyPrefix: 'rlflx',\n   * }\n   */\n  constructor(opts = {}) {\n    this.points = opts.points;\n    this.duration = opts.duration;\n    this.blockDuration = opts.blockDuration;\n    this.execEvenly = opts.execEvenly;\n    this.execEvenlyMinDelayMs = opts.execEvenlyMinDelayMs;\n    this.keyPrefix = opts.keyPrefix;\n  }\n  get points() {\n    return this._points;\n  }\n  set points(value) {\n    this._points = value >= 0 ? value : 4;\n  }\n  get duration() {\n    return this._duration;\n  }\n  set duration(value) {\n    this._duration = typeof value === 'undefined' ? 1 : value;\n  }\n  get msDuration() {\n    return this.duration * 1000;\n  }\n  get blockDuration() {\n    return this._blockDuration;\n  }\n  set blockDuration(value) {\n    this._blockDuration = typeof value === 'undefined' ? 0 : value;\n  }\n  get msBlockDuration() {\n    return this.blockDuration * 1000;\n  }\n  get execEvenly() {\n    return this._execEvenly;\n  }\n  set execEvenly(value) {\n    this._execEvenly = typeof value === 'undefined' ? false : Boolean(value);\n  }\n  get execEvenlyMinDelayMs() {\n    return this._execEvenlyMinDelayMs;\n  }\n  set execEvenlyMinDelayMs(value) {\n    this._execEvenlyMinDelayMs = typeof value === 'undefined' ? Math.ceil(this.msDuration / this.points) : value;\n  }\n  get keyPrefix() {\n    return this._keyPrefix;\n  }\n  set keyPrefix(value) {\n    if (typeof value === 'undefined') {\n      value = 'rlflx';\n    }\n    if (typeof value !== 'string') {\n      throw new Error('keyPrefix must be string');\n    }\n    this._keyPrefix = value;\n  }\n  _getKeySecDuration(options = {}) {\n    return options && options.customDuration >= 0 ? options.customDuration : this.duration;\n  }\n  getKey(key) {\n    return this.keyPrefix.length > 0 ? `${this.keyPrefix}:${key}` : key;\n  }\n  parseKey(rlKey) {\n    return rlKey.substring(this.keyPrefix.length);\n  }\n  consume() {\n    throw new Error(\"You have to implement the method 'consume'!\");\n  }\n  penalty() {\n    throw new Error(\"You have to implement the method 'penalty'!\");\n  }\n  reward() {\n    throw new Error(\"You have to implement the method 'reward'!\");\n  }\n  get() {\n    throw new Error(\"You have to implement the method 'get'!\");\n  }\n  set() {\n    throw new Error(\"You have to implement the method 'set'!\");\n  }\n  block() {\n    throw new Error(\"You have to implement the method 'block'!\");\n  }\n  delete() {\n    throw new Error(\"You have to implement the method 'delete'!\");\n  }\n};","map":{"version":3,"names":["module","exports","RateLimiterAbstract","constructor","opts","points","duration","blockDuration","execEvenly","execEvenlyMinDelayMs","keyPrefix","_points","value","_duration","msDuration","_blockDuration","msBlockDuration","_execEvenly","Boolean","_execEvenlyMinDelayMs","Math","ceil","_keyPrefix","Error","_getKeySecDuration","options","customDuration","getKey","key","length","parseKey","rlKey","substring","consume","penalty","reward","get","set","block","delete"],"sources":["/Users/yezery/Oasis/OASIS/node_modules/.store/rate-limiter-flexible@2.4.2/node_modules/rate-limiter-flexible/lib/RateLimiterAbstract.js"],"sourcesContent":["module.exports = class RateLimiterAbstract {\n  /**\n   *\n   * @param opts Object Defaults {\n   *   points: 4, // Number of points\n   *   duration: 1, // Per seconds\n   *   blockDuration: 0, // Block if consumed more than points in current duration for blockDuration seconds\n   *   execEvenly: false, // Execute allowed actions evenly over duration\n   *   execEvenlyMinDelayMs: duration * 1000 / points, // ms, works with execEvenly=true option\n   *   keyPrefix: 'rlflx',\n   * }\n   */\n  constructor(opts = {}) {\n    this.points = opts.points;\n    this.duration = opts.duration;\n    this.blockDuration = opts.blockDuration;\n    this.execEvenly = opts.execEvenly;\n    this.execEvenlyMinDelayMs = opts.execEvenlyMinDelayMs;\n    this.keyPrefix = opts.keyPrefix;\n  }\n\n  get points() {\n    return this._points;\n  }\n\n  set points(value) {\n    this._points = value >= 0 ? value : 4;\n  }\n\n  get duration() {\n    return this._duration;\n  }\n\n  set duration(value) {\n    this._duration = typeof value === 'undefined' ? 1 : value;\n  }\n\n  get msDuration() {\n    return this.duration * 1000;\n  }\n\n  get blockDuration() {\n    return this._blockDuration;\n  }\n\n  set blockDuration(value) {\n    this._blockDuration = typeof value === 'undefined' ? 0 : value;\n  }\n\n  get msBlockDuration() {\n    return this.blockDuration * 1000;\n  }\n\n  get execEvenly() {\n    return this._execEvenly;\n  }\n\n  set execEvenly(value) {\n    this._execEvenly = typeof value === 'undefined' ? false : Boolean(value);\n  }\n\n  get execEvenlyMinDelayMs() {\n    return this._execEvenlyMinDelayMs;\n  }\n\n  set execEvenlyMinDelayMs(value) {\n    this._execEvenlyMinDelayMs = typeof value === 'undefined' ? Math.ceil(this.msDuration / this.points) : value;\n  }\n\n  get keyPrefix() {\n    return this._keyPrefix;\n  }\n\n  set keyPrefix(value) {\n    if (typeof value === 'undefined') {\n      value = 'rlflx';\n    }\n    if (typeof value !== 'string') {\n      throw new Error('keyPrefix must be string');\n    }\n    this._keyPrefix = value;\n  }\n\n  _getKeySecDuration(options = {}) {\n    return options && options.customDuration >= 0\n      ? options.customDuration\n      : this.duration;\n  }\n\n  getKey(key) {\n    return this.keyPrefix.length > 0 ? `${this.keyPrefix}:${key}` : key;\n  }\n\n  parseKey(rlKey) {\n    return rlKey.substring(this.keyPrefix.length);\n  }\n\n  consume() {\n    throw new Error(\"You have to implement the method 'consume'!\");\n  }\n\n  penalty() {\n    throw new Error(\"You have to implement the method 'penalty'!\");\n  }\n\n  reward() {\n    throw new Error(\"You have to implement the method 'reward'!\");\n  }\n\n  get() {\n    throw new Error(\"You have to implement the method 'get'!\");\n  }\n\n  set() {\n    throw new Error(\"You have to implement the method 'set'!\");\n  }\n\n  block() {\n    throw new Error(\"You have to implement the method 'block'!\");\n  }\n\n  delete() {\n    throw new Error(\"You have to implement the method 'delete'!\");\n  }\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}