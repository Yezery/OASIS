{"ast":null,"code":"'use strict';\n\nmodule.exports = function clear(db, location, keyRange, options, callback) {\n  if (options.limit === 0) return db.nextTick(callback);\n  const transaction = db.db.transaction([location], 'readwrite');\n  const store = transaction.objectStore(location);\n  let count = 0;\n  transaction.oncomplete = function () {\n    callback();\n  };\n  transaction.onabort = function () {\n    callback(transaction.error || new Error('aborted by user'));\n  };\n\n  // A key cursor is faster (skips reading values) but not supported by IE\n  // TODO: we no longer support IE. Test others\n  const method = store.openKeyCursor ? 'openKeyCursor' : 'openCursor';\n  const direction = options.reverse ? 'prev' : 'next';\n  store[method](keyRange, direction).onsuccess = function (ev) {\n    const cursor = ev.target.result;\n    if (cursor) {\n      // Wait for a request to complete before continuing, saving CPU.\n      store.delete(cursor.key).onsuccess = function () {\n        if (options.limit <= 0 || ++count < options.limit) {\n          cursor.continue();\n        }\n      };\n    }\n  };\n};","map":{"version":3,"names":["module","exports","clear","db","location","keyRange","options","callback","limit","nextTick","transaction","store","objectStore","count","oncomplete","onabort","error","Error","method","openKeyCursor","direction","reverse","onsuccess","ev","cursor","target","result","delete","key","continue"],"sources":["/Users/yezery/Oasis/OASIS/node_modules/.store/browser-level@1.0.1/node_modules/browser-level/util/clear.js"],"sourcesContent":["'use strict'\n\nmodule.exports = function clear (db, location, keyRange, options, callback) {\n  if (options.limit === 0) return db.nextTick(callback)\n\n  const transaction = db.db.transaction([location], 'readwrite')\n  const store = transaction.objectStore(location)\n  let count = 0\n\n  transaction.oncomplete = function () {\n    callback()\n  }\n\n  transaction.onabort = function () {\n    callback(transaction.error || new Error('aborted by user'))\n  }\n\n  // A key cursor is faster (skips reading values) but not supported by IE\n  // TODO: we no longer support IE. Test others\n  const method = store.openKeyCursor ? 'openKeyCursor' : 'openCursor'\n  const direction = options.reverse ? 'prev' : 'next'\n\n  store[method](keyRange, direction).onsuccess = function (ev) {\n    const cursor = ev.target.result\n\n    if (cursor) {\n      // Wait for a request to complete before continuing, saving CPU.\n      store.delete(cursor.key).onsuccess = function () {\n        if (options.limit <= 0 || ++count < options.limit) {\n          cursor.continue()\n        }\n      }\n    }\n  }\n}\n"],"mappings":"AAAA,YAAY;;AAEZA,MAAM,CAACC,OAAO,GAAG,SAASC,KAAKA,CAAEC,EAAE,EAAEC,QAAQ,EAAEC,QAAQ,EAAEC,OAAO,EAAEC,QAAQ,EAAE;EAC1E,IAAID,OAAO,CAACE,KAAK,KAAK,CAAC,EAAE,OAAOL,EAAE,CAACM,QAAQ,CAACF,QAAQ,CAAC;EAErD,MAAMG,WAAW,GAAGP,EAAE,CAACA,EAAE,CAACO,WAAW,CAAC,CAACN,QAAQ,CAAC,EAAE,WAAW,CAAC;EAC9D,MAAMO,KAAK,GAAGD,WAAW,CAACE,WAAW,CAACR,QAAQ,CAAC;EAC/C,IAAIS,KAAK,GAAG,CAAC;EAEbH,WAAW,CAACI,UAAU,GAAG,YAAY;IACnCP,QAAQ,CAAC,CAAC;EACZ,CAAC;EAEDG,WAAW,CAACK,OAAO,GAAG,YAAY;IAChCR,QAAQ,CAACG,WAAW,CAACM,KAAK,IAAI,IAAIC,KAAK,CAAC,iBAAiB,CAAC,CAAC;EAC7D,CAAC;;EAED;EACA;EACA,MAAMC,MAAM,GAAGP,KAAK,CAACQ,aAAa,GAAG,eAAe,GAAG,YAAY;EACnE,MAAMC,SAAS,GAAGd,OAAO,CAACe,OAAO,GAAG,MAAM,GAAG,MAAM;EAEnDV,KAAK,CAACO,MAAM,CAAC,CAACb,QAAQ,EAAEe,SAAS,CAAC,CAACE,SAAS,GAAG,UAAUC,EAAE,EAAE;IAC3D,MAAMC,MAAM,GAAGD,EAAE,CAACE,MAAM,CAACC,MAAM;IAE/B,IAAIF,MAAM,EAAE;MACV;MACAb,KAAK,CAACgB,MAAM,CAACH,MAAM,CAACI,GAAG,CAAC,CAACN,SAAS,GAAG,YAAY;QAC/C,IAAIhB,OAAO,CAACE,KAAK,IAAI,CAAC,IAAI,EAAEK,KAAK,GAAGP,OAAO,CAACE,KAAK,EAAE;UACjDgB,MAAM,CAACK,QAAQ,CAAC,CAAC;QACnB;MACF,CAAC;IACH;EACF,CAAC;AACH,CAAC"},"metadata":{},"sourceType":"script","externalDependencies":[]}