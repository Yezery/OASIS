{"ast":null,"code":"import { HKDF } from '@stablelib/hkdf';\nimport * as x25519 from '@stablelib/x25519';\nimport { SHA256, hash } from '@stablelib/sha256';\nimport { ChaCha20Poly1305 } from '@stablelib/chacha20poly1305';\nexport const stablelib = {\n  hashSHA256(data) {\n    return hash(data);\n  },\n  getHKDF(ck, ikm) {\n    const hkdf = new HKDF(SHA256, ikm, ck);\n    const okmU8Array = hkdf.expand(96);\n    const okm = okmU8Array;\n    const k1 = okm.subarray(0, 32);\n    const k2 = okm.subarray(32, 64);\n    const k3 = okm.subarray(64, 96);\n    return [k1, k2, k3];\n  },\n  generateX25519KeyPair() {\n    const keypair = x25519.generateKeyPair();\n    return {\n      publicKey: keypair.publicKey,\n      privateKey: keypair.secretKey\n    };\n  },\n  generateX25519KeyPairFromSeed(seed) {\n    const keypair = x25519.generateKeyPairFromSeed(seed);\n    return {\n      publicKey: keypair.publicKey,\n      privateKey: keypair.secretKey\n    };\n  },\n  generateX25519SharedKey(privateKey, publicKey) {\n    return x25519.sharedKey(privateKey, publicKey);\n  },\n  chaCha20Poly1305Encrypt(plaintext, nonce, ad, k) {\n    const ctx = new ChaCha20Poly1305(k);\n    return ctx.seal(nonce, plaintext, ad);\n  },\n  chaCha20Poly1305Decrypt(ciphertext, nonce, ad, k, dst) {\n    const ctx = new ChaCha20Poly1305(k);\n    return ctx.open(nonce, ciphertext, ad, dst);\n  }\n};","map":{"version":3,"names":["HKDF","x25519","SHA256","hash","ChaCha20Poly1305","stablelib","hashSHA256","data","getHKDF","ck","ikm","hkdf","okmU8Array","expand","okm","k1","subarray","k2","k3","generateX25519KeyPair","keypair","generateKeyPair","publicKey","privateKey","secretKey","generateX25519KeyPairFromSeed","seed","generateKeyPairFromSeed","generateX25519SharedKey","sharedKey","chaCha20Poly1305Encrypt","plaintext","nonce","ad","k","ctx","seal","chaCha20Poly1305Decrypt","ciphertext","dst","open"],"sources":["../../../src/crypto/stablelib.ts"],"sourcesContent":[null],"mappings":"AAAA,SAASA,IAAI,QAAQ,iBAAiB;AACtC,OAAO,KAAKC,MAAM,MAAM,mBAAmB;AAC3C,SAASC,MAAM,EAAEC,IAAI,QAAQ,mBAAmB;AAChD,SAASC,gBAAgB,QAAQ,6BAA6B;AAM9D,OAAO,MAAMC,SAAS,GAAqB;EACzCC,UAAUA,CAAEC,IAAgB;IAC1B,OAAOJ,IAAI,CAACI,IAAI,CAAC;EACnB,CAAC;EAEDC,OAAOA,CAAEC,EAAW,EAAEC,GAAe;IACnC,MAAMC,IAAI,GAAG,IAAIX,IAAI,CAACE,MAAM,EAAEQ,GAAG,EAAED,EAAE,CAAC;IACtC,MAAMG,UAAU,GAAGD,IAAI,CAACE,MAAM,CAAC,EAAE,CAAC;IAClC,MAAMC,GAAG,GAAGF,UAAU;IAEtB,MAAMG,EAAE,GAAGD,GAAG,CAACE,QAAQ,CAAC,CAAC,EAAE,EAAE,CAAC;IAC9B,MAAMC,EAAE,GAAGH,GAAG,CAACE,QAAQ,CAAC,EAAE,EAAE,EAAE,CAAC;IAC/B,MAAME,EAAE,GAAGJ,GAAG,CAACE,QAAQ,CAAC,EAAE,EAAE,EAAE,CAAC;IAE/B,OAAO,CAACD,EAAE,EAAEE,EAAE,EAAEC,EAAE,CAAC;EACrB,CAAC;EAEDC,qBAAqBA,CAAA;IACnB,MAAMC,OAAO,GAAGnB,MAAM,CAACoB,eAAe,EAAE;IAExC,OAAO;MACLC,SAAS,EAAEF,OAAO,CAACE,SAAS;MAC5BC,UAAU,EAAEH,OAAO,CAACI;KACrB;EACH,CAAC;EAEDC,6BAA6BA,CAAEC,IAAgB;IAC7C,MAAMN,OAAO,GAAGnB,MAAM,CAAC0B,uBAAuB,CAACD,IAAI,CAAC;IAEpD,OAAO;MACLJ,SAAS,EAAEF,OAAO,CAACE,SAAS;MAC5BC,UAAU,EAAEH,OAAO,CAACI;KACrB;EACH,CAAC;EAEDI,uBAAuBA,CAAEL,UAAsB,EAAED,SAAqB;IACpE,OAAOrB,MAAM,CAAC4B,SAAS,CAACN,UAAU,EAAED,SAAS,CAAC;EAChD,CAAC;EAEDQ,uBAAuBA,CAAEC,SAAqB,EAAEC,KAAiB,EAAEC,EAAc,EAAEC,CAAU;IAC3F,MAAMC,GAAG,GAAG,IAAI/B,gBAAgB,CAAC8B,CAAC,CAAC;IAEnC,OAAOC,GAAG,CAACC,IAAI,CAACJ,KAAK,EAAED,SAAS,EAAEE,EAAE,CAAC;EACvC,CAAC;EAEDI,uBAAuBA,CAAEC,UAAsB,EAAEN,KAAiB,EAAEC,EAAc,EAAEC,CAAU,EAAEK,GAAgB;IAC9G,MAAMJ,GAAG,GAAG,IAAI/B,gBAAgB,CAAC8B,CAAC,CAAC;IAEnC,OAAOC,GAAG,CAACK,IAAI,CAACR,KAAK,EAAEM,UAAU,EAAEL,EAAE,EAAEM,GAAG,CAAC;EAC7C;CACD"},"metadata":{},"sourceType":"module","externalDependencies":[]}