{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nlet socket;\nimport { sendToGPT } from \"@/api/axios/gpt\";\nimport { newWebSocket } from \"@/utils/webStocket\";\nimport { parseTime } from \"@/utils/Time\";\nexport default {\n  data() {\n    return {\n      user: {},\n      isCollapse: false,\n      users: [],\n      messages: [],\n      chatUser: \"\",\n      text: \"\",\n      contents: {},\n      showName: false,\n      isEnter: false,\n      GPTReply: [],\n      response: \"\",\n      typing: '',\n      showTyping: false,\n      intervalId: null\n    };\n  },\n  components: {},\n  mounted() {},\n  methods: {\n    // 更新弹窗位置\n    upDatePosition() {\n      this.$nextTick(() => {\n        this.$refs.popoverRef.updatePopper();\n      });\n    },\n    OpenAndClose() {\n      this.isOpen = !this.isOpen;\n      if (this.isOpen) {\n        this.$refs.logo.classList.add(\"animate__swing\");\n        this.$refs.logo2.classList.add(\"animate__swing\");\n        this.$refs.Menu.style = \"width:150px;\";\n        this.showName = true;\n        this.isEnter = true;\n      } else {\n        this.$refs.logo.classList.remove(\"animate__swing\");\n        this.$refs.logo2.classList.remove(\"animate__swing\");\n        this.$refs.Menu.style = \"width:65px;\";\n        this.showName = false;\n        this.isEnter = false;\n      }\n    },\n    GETHashAvatar(UserAddress) {\n      return \"data:image/png;base64,\" + new this.Identicon(UserAddress, 120).toString();\n    },\n    send(opt) {\n      if (!this.text) {\n        this.$notify({\n          title: \"输入不能为空\",\n          type: \"warning\",\n          position: \"bottom-left\"\n        });\n      } else {\n        if (opt == 1) {\n          if (typeof WebSocket == \"undefined\") {\n            console.log(\"您的浏览器不支持WebSocket\");\n          } else {\n            console.log(\"您的浏览器支持WebSocket\");\n            // 组装待发送的消息 json\n            // {\"from\": \"zhang\", \"to\": \"admin\", \"text\": \"聊天文本\"}\n            let message = {\n              from: this.user.username,\n              to: this.chatUser,\n              message: this.text\n            };\n            socket.send(JSON.stringify(message)); // 将组装好的json发送给服务端，\n\n            // 由服务端进行转发\n            this.messages.push({\n              user: this.user.username,\n              text: this.text\n            });\n\n            // 构建消息内容，本人消息\n            this.createContent(null, this.$store.state.currentAddress, this.text);\n            this.text = \"\";\n          }\n        } else {\n          this.sendToGPT();\n        }\n      }\n    },\n    async sendToGPT() {\n      const text = this.text;\n      var data = {\n        role: \"user\",\n        content: text\n      };\n      this.text = \"\";\n      this.createContent(null, this.$store.state.currentAddress, text);\n      try {\n        await sendToGPT(data).then(re => {\n          let results = this.parsePack(re.data.data);\n          for (const result of results) {\n            if (result.choices[0].finish_reason !== null) {\n              return;\n            }\n            this.GPTReply.push(result.choices[0].delta.content);\n          }\n        });\n        console.log(this.GPTReply);\n        this.Typewriter();\n        //     .then(re => {\n        //   this.createContent(re.data.choices[0].message.role,null,re.data.choices[0].message.content)\n        //   console.log(re);\n        // })\n      } catch (error) {\n        console.log(error);\n      }\n    },\n    //  解析gptreuslt\n    parsePack(str) {\n      // 定义正则表达式匹配模式\n      const pattern = /data:\\s*({.*?})\\s*\\n/g;\n      // 定义一个数组来存储所有匹 配到的 JSON 对象\n      const result = [];\n      // 使用正则表达式匹配完整的 JSON 对象并解析它们\n      let match;\n      while ((match = pattern.exec(str)) !== null) {\n        const jsonStr = match[1];\n        try {\n          const json = JSON.parse(jsonStr);\n          result.push(json);\n        } catch (e) {\n          console.log(e);\n        }\n      }\n      // 输出所有解析出的 JSON 对象\n      return result;\n    },\n    //打字机\n    Typewriter() {\n      let message = this.GPTReply;\n      let i = 0;\n      const typingDelay = Math.floor(Math.random() * 100) + 50; // 随机生成打字的延迟时间\n      const msgLength = this.GPTReply.length;\n      const typeNextLetter = () => {\n        message[message.length - 1].content += message.charAt(i);\n        i++;\n        if (i <= msgLength) {\n          setTimeout(typeNextLetter, typingDelay);\n        } else {\n          clearTimeout(this.intervalId);\n          this.showTyping = false;\n          this.intervalId = setTimeout(() => {\n            this.addMessage({\n              content: '...'\n            });\n          }, Math.floor(Math.random() * 5000) + 1000);\n        }\n      };\n      clearTimeout(this.intervalId);\n      this.showTyping = true;\n      this.intervalId = setTimeout(typeNextLetter, 500);\n    },\n    // 键盘回车事件\n    handleKeyCode(event) {\n      if (event.keyCode == 13) {\n        if (!event.metaKey) {\n          event.preventDefault();\n          this.send();\n        } else {\n          this.text = this.text + \"\\n\";\n        }\n      } else {\n        if (!event.metaKey) {\n          event.preventDefault();\n          this.send();\n        } else {\n          this.text = this.text + \"\\n\";\n        }\n      }\n    },\n    createContent(remoteUser, nowUser, text) {\n      let content;\n      let html;\n      content = this.contents[this.chatUser || remoteUser] || \"\";\n      // 当前用户消息\n      if (nowUser) {\n        html = `<div class=\"MessageBox_nowUser\"><span class=\"currentTime\">${parseTime(Date(), \"hh:mm:ss\")}</span><div class=\"Message leftMessage\">${text}</div></div>`;\n      } else if (remoteUser) {\n        html = `\n                                  <div class=\"MessageBox_remoteUser\">\n                                    <span class=\"currentTime\">${parseTime(Date(), \"hh:mm:ss\")}</span>\n                                    <div class=\"Message rightMessage\">\n                                      ${text}\n                                    </div>\n                                  </div>\n                                `;\n      }\n      content += html;\n      this.$set(this.contents, this.chatUser, content);\n      this.$nextTick(() => {\n        let msg = document.getElementById(\"CHAT\");\n        msg.scrollTop = msg.scrollHeight;\n      });\n    },\n    //开启websocket事务\n    init() {\n      // 格式[\"username:admin\",\"username:admin2\"]\n      let object = {\n        username: this.$store.state.currentAddress\n      };\n      localStorage.setItem(\"user\", JSON.stringify(object));\n      this.user = localStorage.getItem(\"user\") ? JSON.parse(localStorage.getItem(\"user\")) : {};\n      let username = this.user.username;\n      let _this = this;\n      if (typeof WebSocket == \"undefined\") {\n        console.log(\"您的浏览器不支持WebSocket\");\n      } else {\n        console.log(\"您的浏览器支持WebSocket\");\n        if (socket != null) {\n          socket.close();\n          socket = null;\n        }\n        // 开启一个websocket服务\n        socket = newWebSocket(\"/OasisChat/\", username);\n\n        //打开事件\n        socket.onopen = function () {\n          console.log(\"websocket已打开\");\n        };\n        //  浏览器端收消息，获得从服务端发送过来的文本消息\n        socket.onmessage = function (msg) {\n          _this.$nextTick(() => {\n            console.log(\"收到数据====\" + msg.data);\n            let data = JSON.parse(msg.data);\n            if (data.users) {\n              _this.users = data.users.filter(user => user.username !== username);\n            } else {\n              if (data.from === _this.chatUser) {\n                _this.messages.push(data);\n                _this.createContent(data.from, null, data.message);\n              }\n            }\n          });\n        };\n        //关闭事件\n        socket.onclose = function () {\n          console.log(\"websocket已关闭\");\n        };\n        //发生了错误事件\n        socket.onerror = function () {\n          console.log(\"websocket发生了错误\");\n        };\n      }\n    }\n  }\n};","map":{"version":3,"names":["socket","sendToGPT","newWebSocket","parseTime","data","user","isCollapse","users","messages","chatUser","text","contents","showName","isEnter","GPTReply","response","typing","showTyping","intervalId","components","mounted","methods","upDatePosition","$nextTick","$refs","popoverRef","updatePopper","OpenAndClose","isOpen","logo","classList","add","logo2","Menu","style","remove","GETHashAvatar","UserAddress","Identicon","toString","send","opt","$notify","title","type","position","WebSocket","console","log","message","from","username","to","JSON","stringify","push","createContent","$store","state","currentAddress","role","content","then","re","results","parsePack","result","choices","finish_reason","delta","Typewriter","error","str","pattern","match","exec","jsonStr","json","parse","e","i","typingDelay","Math","floor","random","msgLength","length","typeNextLetter","charAt","setTimeout","clearTimeout","addMessage","handleKeyCode","event","keyCode","metaKey","preventDefault","remoteUser","nowUser","html","Date","$set","msg","document","getElementById","scrollTop","scrollHeight","init","object","localStorage","setItem","getItem","_this","close","onopen","onmessage","filter","onclose","onerror"],"sources":["src/views/leftMenu/oasisChat.vue"],"sourcesContent":["<template>\n  <div\n    class=\"Menu\"\n    ref=\"Menu\"\n    :class=\"{'isEnter':isEnter}\"\n    @mouseenter=\"OpenAndClose\"\n    @mouseleave=\"OpenAndClose\"\n  >\n    <div class=\"logobox\">\n      <div class=\"logo animate__animated\">\n        <router-link :to=\"{ name: 'MarketShop' }\">\n          <div\n            style=\"display: inline; font-size: 25px\"\n            class=\"animate__animated\"\n            ref=\"logo\"\n          >\n            OAS\n          </div>\n          <div\n            style=\"display: inline;  font-size: 25px\"\n            class=\"animate__animated\"\n            ref=\"logo2\"\n          >\n            <img\n              src=\"../../assets/webAssets/s1.png\"\n              alt=\"\"\n              width=\"22px\"\n              height=\"22px\"\n            >S\n          </div>\n        </router-link>\n      </div>\n    </div>\n\n    <template>\n      <!-- <div\n        v-for=\"otherUser in users\"\n        :key=\"otherUser.username\"\n        class=\"chat\"\n      >\n        <el-popover\n          placement=\"right\"\n          width=\"309px\"\n          trigger=\"click\"\n          popper-class=\"monitor-yt-popover\"\n        >\n          <div\n            class=\"ChatPeople animate__animated animate__fadeInRight\"\n            slot=\"reference\"\n            @click=\"chatUser = otherUser.username\"\n          >\n            <div class=\"ChatWindow\">\n              <img\n                :src=\"GETHashAvatar(otherUser.username)\"\n                width=\"50px\"\n                height=\"50px\"\n                alt=\"\"\n                style=\"object-fit: contain\"\n              >\n            </div>\n            <span class=\"friendname animate__animated animate__fadeInRight\">{{ otherUser.username.slice(0, 3) + \"...\" + otherUser.username.slice(39) }}</span>\n          </div>\n          <div\n            style=\"\n              display: flex;\n              flex-direction: column;\n              justify-content: center;\n              align-items: center;\n            \"\n          >\n            <div\n              class=\"ChatWindowBox\"\n              style=\"width: 329px; height: 520px\"\n            >\n              <el-container>\n                <el-header>\n                  <div class=\"topBox\">\n                    <div\n                      style=\"\n                        flex: 1;\n                        justify-content: center;\n                        align-items: center;\n                        display: flex;\n                      \"\n                    >\n                      <span\n                        class=\"el-avatar el-avatar--circle\"\n                        style=\"height: 48px; width: 48px\"\n                        v-if=\"chatUser != ''\"\n                      >\n                        <img\n                          :src=\"GETHashAvatar(otherUser.username)\"\n                          style=\"object-fit: contain\"\n                        >\n                      </span>\n                    </div>\n                    <div style=\"flex: 7; text-align: left; height: 48px\">\n                      <div style=\"margin-left: 5px\">\n                        <div class=\"ChatUserName\">\n                          {{ chatUser.slice(0, 5) + \"...\" + chatUser.slice(37) }}\n                        </div>\n                        <div\n                          style=\"\n                            font-size: 12px;\n                            color: limegreen;\n                            margin-left: 5px;\n                            font-weight: 600;\n                            font-size: 14px;\n                          \"\n                          v-if=\"chatUser != ''\"\n                        >\n                          <i class=\"el-icon-loading\" /> Chatting...\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </el-header>\n\n                <el-main>\n                  <div\n                    style=\"height: 355px; overflow: auto\"\n                    id=\"CHAT\"\n                    v-html=\"contents[chatUser]\"\n                  />\n                </el-main>\n                <el-footer>\n                  <div class=\"inputer\">\n                    <input\n                      type=\"textarea\"\n                      autofocus=\"true\"\n                      v-model=\"text\"\n                      class=\"inputarea\"\n                      @keydown.enter.prevent=\"handleKeyCode($event)\"\n                    >\n                    <button @click=\"send\">\n                      <i\n                        class=\"el-icon-arrow-up\"\n                        style=\"font-size: 30px;cursor: pointer;\"\n                      />\n                    </button>\n                  </div>\n                </el-footer>\n              </el-container>\n            </div>\n          </div>\n        </el-popover>\n      </div> -->\n      <div class=\"chatGPT\">\n        <el-popover\n          placement=\"right\"\n          width=\"309px\"\n          trigger=\"click\"\n          popper-class=\"monitor-yt-popover\"\n        >\n          <div\n            class=\"ChatPeople animate__animated animate__fadeInRight\"\n            slot=\"reference\"\n          >\n            <div class=\"ChatWindow\">\n              <img\n                src=\"@/assets/webAssets/MetaMask.png\"\n                width=\"50px\"\n                height=\"50px\"\n                alt=\"\"\n                style=\"object-fit: contain\"\n              >\n            </div>\n            <span\n              class=\"friendname animate__animated animate__fadeInRight\"\n              v-show=\"showName\"\n            >OasisGPT</span>\n          </div>\n          <div\n            style=\"\n              display: flex;\n              flex-direction: column;\n              justify-content: center;\n              align-items: center;\n            \"\n          >\n            <div\n              class=\"ChatWindowBox\"\n              style=\"width: 329px; height: 520px\"\n            >\n              <el-container>\n                <el-header>\n                  <div class=\"topBox\">\n                    <div\n                      style=\"\n                        flex: 1;\n                        justify-content: center;\n                        align-items: center;\n                        display: flex;\n                      \"\n                    >\n                      <span\n                        class=\"el-avatar el-avatar--circle\"\n                        style=\"height: 48px; width: 48px\"\n                        v-if=\"chatUser != ''\"\n                      >\n                        <img\n                          src=\"@/assets/webAssets/MetaMask.png\"\n                          style=\"object-fit: contain\"\n                        >\n                      </span>\n                    </div>\n                    <div style=\"flex: 7; text-align: left; height: 48px\">\n                      <div style=\"margin-left: 5px\">\n                        <div class=\"ChatUserName\">\n                          <!-- {{ chatUser.slice(0, 5) + \"...\" + chatUser.slice(37) }} -->\n                        </div>\n                        <div\n                          style=\"\n                            font-size: 12px;\n                            color: limegreen;\n                            margin-left: 5px;\n                            font-weight: 600;\n                            font-size: 14px;\n                          \"\n                        >\n                          <!-- v-if=\"chatUser != ''\" -->\n                          <i class=\"el-icon-loading\" /> Chatting...\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </el-header>\n\n                <el-main>\n                  <!-- <div style=\"height: 355px; overflow: auto\" id=\"CHAT\" v-html=\"contents[chatUser]\" /> -->\n                  <div style=\"height: 355px; overflow: auto\" id=\"CHAT\">\n                    <template v-for=\"i in GPTReply\">\n                        <span key=\"i\"></span>\n                        \n                      \n                    </template>\n                  </div>\n                  <!-- <div class=\"chat\">\n                    <div\n                      class=\"chat-bubble\"\n                      v-for=\"(message, index) in messages\"\n                      :key=\"index\"\n                    >\n                      <div>{{ message.content }}</div>\n                      <span v-if=\"showTyping && index === messages.length - 1\">{{ typing }}</span>\n                    </div>\n                  </div> -->\n                </el-main>\n                <el-footer>\n                  <div class=\"inputer\">\n                    <input\n                      type=\"textarea\"\n                      autofocus=\"true\"\n                      v-model=\"text\"\n                      class=\"inputarea\"\n                      @keydown.enter.prevent=\"send(2)\"\n                    >\n                    <button @click=\"send(2)\">\n                      <i\n                        class=\"el-icon-arrow-up\"\n                        style=\"font-size: 30px;cursor: pointer;\"\n                      />\n                    </button>\n                  </div>\n                </el-footer>\n              </el-container>\n            </div>\n          </div>\n        </el-popover>\n      </div>\n    </template>\n  </div>\n</template>\n\n<script>\n  let socket;\n  import { sendToGPT } from \"@/api/axios/gpt\";\n  import { newWebSocket } from \"@/utils/webStocket\";\n  import { parseTime } from \"@/utils/Time\";\n  export default {\n    data() {\n      return {\n        user: {},\n        isCollapse: false,\n        users: [],\n        messages: [],\n        chatUser: \"\",\n        text: \"\",\n        contents: {},\n        showName: false,\n        isEnter: false,\n\n        GPTReply: [],\n        response: \"\",\n      typing: '',\n      showTyping: false,\n      intervalId: null\n      };\n    },\n    components: {},\n    mounted() {},\n    methods: {\n      // 更新弹窗位置\n      upDatePosition() {\n        this.$nextTick(() => {\n          this.$refs.popoverRef.updatePopper();\n        });\n      },\n      OpenAndClose() {\n        this.isOpen = !this.isOpen;\n        if (this.isOpen) {\n          this.$refs.logo.classList.add(\"animate__swing\");\n          this.$refs.logo2.classList.add(\"animate__swing\");\n          this.$refs.Menu.style = \"width:150px;\";\n          this.showName = true;\n          this.isEnter = true;\n        } else {\n          this.$refs.logo.classList.remove(\"animate__swing\");\n          this.$refs.logo2.classList.remove(\"animate__swing\");\n          this.$refs.Menu.style = \"width:65px;\";\n          this.showName = false;\n          this.isEnter = false;\n        }\n      },\n      GETHashAvatar(UserAddress) {\n        return (\n          \"data:image/png;base64,\" +\n          new this.Identicon(UserAddress, 120).toString()\n        );\n      },\n      send(opt) {\n        if (!this.text) {\n          this.$notify({\n            title: \"输入不能为空\",\n            type: \"warning\",\n            position: \"bottom-left\",\n          });\n        } else {\n          if (opt == 1) {\n            if (typeof WebSocket == \"undefined\") {\n              console.log(\"您的浏览器不支持WebSocket\");\n            } else {\n              console.log(\"您的浏览器支持WebSocket\");\n              // 组装待发送的消息 json\n              // {\"from\": \"zhang\", \"to\": \"admin\", \"text\": \"聊天文本\"}\n              let message = {\n                from: this.user.username,\n                to: this.chatUser,\n                message: this.text,\n              };\n\n              socket.send(JSON.stringify(message)); // 将组装好的json发送给服务端，\n\n              // 由服务端进行转发\n              this.messages.push({\n                user: this.user.username,\n                text: this.text,\n              });\n\n              // 构建消息内容，本人消息\n              this.createContent(\n                null,\n                this.$store.state.currentAddress,\n                this.text\n              );\n              this.text = \"\";\n            }\n          } else {\n            this.sendToGPT();\n          }\n        }\n      },\n      async sendToGPT() {\n        const text = this.text;\n        var data = {\n          role: \"user\",\n          content: text,\n        };\n        this.text = \"\";\n\n        this.createContent(null, this.$store.state.currentAddress, text);\n        try {\n          await sendToGPT(data).then((re) => {\n            let results = this.parsePack(re.data.data);\n            for (const result of results) {\n              if (result.choices[0].finish_reason !== null) {\n                return;\n              }\n              this.GPTReply.push(result.choices[0].delta.content);\n            }\n          });\n          console.log(this.GPTReply);\n          this.Typewriter()\n          //     .then(re => {\n          //   this.createContent(re.data.choices[0].message.role,null,re.data.choices[0].message.content)\n          //   console.log(re);\n          // })\n        } catch (error) {\n          console.log(error);\n        }\n      },\n\n      //  解析gptreuslt\n      parsePack(str) {\n        // 定义正则表达式匹配模式\n        const pattern = /data:\\s*({.*?})\\s*\\n/g;\n        // 定义一个数组来存储所有匹 配到的 JSON 对象\n        const result = [];\n        // 使用正则表达式匹配完整的 JSON 对象并解析它们\n        let match;\n        while ((match = pattern.exec(str)) !== null) {\n          const jsonStr = match[1];\n          try {\n            const json = JSON.parse(jsonStr);\n            result.push(json);\n          } catch (e) {\n            console.log(e);\n          }\n        }\n        // 输出所有解析出的 JSON 对象\n        return result;\n      },\n      //打字机\n      Typewriter() {\n        let message= this.GPTReply\n        let i = 0\n        const typingDelay = Math.floor(Math.random() * 100) + 50 // 随机生成打字的延迟时间\n        const msgLength = this.GPTReply.length\n        const typeNextLetter = () => {\n          message[message.length - 1].content += message.charAt(i)\n        i++\n\n        if (i <= msgLength) {\n          setTimeout(typeNextLetter, typingDelay)\n        } else {\n          clearTimeout(this.intervalId)\n          this.showTyping = false\n\n          this.intervalId = setTimeout(() => {\n            this.addMessage({\n              content: '...'\n            })\n          }, Math.floor(Math.random() * 5000) + 1000)\n        }\n        }\n        clearTimeout(this.intervalId)\n      this.showTyping = true\n\n      this.intervalId = setTimeout(typeNextLetter, 500)\n      },\n      // 键盘回车事件\n      handleKeyCode(event) {\n        if (event.keyCode == 13) {\n          if (!event.metaKey) {\n            event.preventDefault();\n            this.send();\n          } else {\n            this.text = this.text + \"\\n\";\n          }\n        } else {\n          if (!event.metaKey) {\n            event.preventDefault();\n            this.send();\n          } else {\n            this.text = this.text + \"\\n\";\n          }\n        }\n      },\n      createContent(remoteUser, nowUser, text) {\n        let content;\n        let html;\n        content = this.contents[this.chatUser || remoteUser] || \"\";\n        // 当前用户消息\n        if (nowUser) {\n          html = `<div class=\"MessageBox_nowUser\"><span class=\"currentTime\">${parseTime(\n            Date(),\n            \"hh:mm:ss\"\n          )}</span><div class=\"Message leftMessage\">${text}</div></div>`;\n        } else if (remoteUser) {\n          html = `\n                                  <div class=\"MessageBox_remoteUser\">\n                                    <span class=\"currentTime\">${parseTime(\n                                      Date(),\n                                      \"hh:mm:ss\"\n                                    )}</span>\n                                    <div class=\"Message rightMessage\">\n                                      ${text}\n                                    </div>\n                                  </div>\n                                `;\n        }\n        content += html;\n        this.$set(this.contents, this.chatUser, content);\n        this.$nextTick(() => {\n          let msg = document.getElementById(\"CHAT\");\n          msg.scrollTop = msg.scrollHeight;\n        });\n      },\n      //开启websocket事务\n      init() {\n        // 格式[\"username:admin\",\"username:admin2\"]\n        let object = {\n          username: this.$store.state.currentAddress,\n        };\n        localStorage.setItem(\"user\", JSON.stringify(object));\n\n        this.user = localStorage.getItem(\"user\")\n          ? JSON.parse(localStorage.getItem(\"user\"))\n          : {};\n        let username = this.user.username;\n\n        let _this = this;\n\n        if (typeof WebSocket == \"undefined\") {\n          console.log(\"您的浏览器不支持WebSocket\");\n        } else {\n          console.log(\"您的浏览器支持WebSocket\");\n          if (socket != null) {\n            socket.close();\n            socket = null;\n          }\n          // 开启一个websocket服务\n          socket = newWebSocket(\"/OasisChat/\", username);\n\n          //打开事件\n          socket.onopen = function () {\n            console.log(\"websocket已打开\");\n          };\n          //  浏览器端收消息，获得从服务端发送过来的文本消息\n          socket.onmessage = function (msg) {\n            _this.$nextTick(() => {\n              console.log(\"收到数据====\" + msg.data);\n              let data = JSON.parse(msg.data);\n              if (data.users) {\n                _this.users = data.users.filter(\n                  (user) => user.username !== username\n                );\n              } else {\n                if (data.from === _this.chatUser) {\n                  _this.messages.push(data);\n                  _this.createContent(data.from, null, data.message);\n                }\n              }\n            });\n          };\n          //关闭事件\n          socket.onclose = function () {\n            console.log(\"websocket已关闭\");\n          };\n          //发生了错误事件\n          socket.onerror = function () {\n            console.log(\"websocket发生了错误\");\n          };\n        }\n      },\n    },\n  };\n</script>\n<style lang=\"scss\" scoped>\n@import \"@/style/leftMenu/oasisChat.scss\";\n\n\n\n.chat {\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-start;\n  align-items: flex-start;\n}\n\n.chat-bubble {\n  margin: 5px;\n  padding: 10px;\n  border-radius: 10px;\n  background: #eee;\n  color: #333;\n  display: inline-block;\n  max-width: 70%;\n  word-break: break-word;\n}\n\n.chat-bubble:last-child {\n  margin-bottom: 20px;\n}\n</style>\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}