{"ast":null,"code":"import * as mafmt from '@multiformats/mafmt';\nimport { CODE_CIRCUIT, CODE_P2P, CODE_TCP, CODE_WS, CODE_WSS } from './constants.js';\nexport function all(multiaddrs) {\n  return multiaddrs.filter(ma => {\n    if (ma.protoCodes().includes(CODE_CIRCUIT)) {\n      return false;\n    }\n    const testMa = ma.decapsulateCode(CODE_P2P);\n    return mafmt.WebSockets.matches(testMa) || mafmt.WebSocketsSecure.matches(testMa);\n  });\n}\nexport function wss(multiaddrs) {\n  return multiaddrs.filter(ma => {\n    if (ma.protoCodes().includes(CODE_CIRCUIT)) {\n      return false;\n    }\n    const testMa = ma.decapsulateCode(CODE_P2P);\n    return mafmt.WebSocketsSecure.matches(testMa);\n  });\n}\nexport function dnsWss(multiaddrs) {\n  return multiaddrs.filter(ma => {\n    if (ma.protoCodes().includes(CODE_CIRCUIT)) {\n      return false;\n    }\n    const testMa = ma.decapsulateCode(CODE_P2P);\n    return mafmt.WebSocketsSecure.matches(testMa) && mafmt.DNS.matches(testMa.decapsulateCode(CODE_TCP).decapsulateCode(CODE_WSS));\n  });\n}\nexport function dnsWsOrWss(multiaddrs) {\n  return multiaddrs.filter(ma => {\n    if (ma.protoCodes().includes(CODE_CIRCUIT)) {\n      return false;\n    }\n    const testMa = ma.decapsulateCode(CODE_P2P);\n    // WS\n    if (mafmt.WebSockets.matches(testMa)) {\n      return mafmt.DNS.matches(testMa.decapsulateCode(CODE_TCP).decapsulateCode(CODE_WS));\n    }\n    // WSS\n    return mafmt.WebSocketsSecure.matches(testMa) && mafmt.DNS.matches(testMa.decapsulateCode(CODE_TCP).decapsulateCode(CODE_WSS));\n  });\n}","map":{"version":3,"names":["mafmt","CODE_CIRCUIT","CODE_P2P","CODE_TCP","CODE_WS","CODE_WSS","all","multiaddrs","filter","ma","protoCodes","includes","testMa","decapsulateCode","WebSockets","matches","WebSocketsSecure","wss","dnsWss","DNS","dnsWsOrWss"],"sources":["../../src/filters.ts"],"sourcesContent":[null],"mappings":"AAAA,OAAO,KAAKA,KAAK,MAAM,qBAAqB;AAE5C,SACEC,YAAY,EACZC,QAAQ,EACRC,QAAQ,EACRC,OAAO,EACPC,QAAQ,QACH,gBAAgB;AAEvB,OAAM,SAAUC,GAAGA,CAAEC,UAAuB;EAC1C,OAAOA,UAAU,CAACC,MAAM,CAAEC,EAAE,IAAI;IAC9B,IAAIA,EAAE,CAACC,UAAU,EAAE,CAACC,QAAQ,CAACV,YAAY,CAAC,EAAE;MAC1C,OAAO,KAAK;;IAGd,MAAMW,MAAM,GAAGH,EAAE,CAACI,eAAe,CAACX,QAAQ,CAAC;IAE3C,OAAOF,KAAK,CAACc,UAAU,CAACC,OAAO,CAACH,MAAM,CAAC,IACrCZ,KAAK,CAACgB,gBAAgB,CAACD,OAAO,CAACH,MAAM,CAAC;EAC1C,CAAC,CAAC;AACJ;AAEA,OAAM,SAAUK,GAAGA,CAAEV,UAAuB;EAC1C,OAAOA,UAAU,CAACC,MAAM,CAAEC,EAAE,IAAI;IAC9B,IAAIA,EAAE,CAACC,UAAU,EAAE,CAACC,QAAQ,CAACV,YAAY,CAAC,EAAE;MAC1C,OAAO,KAAK;;IAGd,MAAMW,MAAM,GAAGH,EAAE,CAACI,eAAe,CAACX,QAAQ,CAAC;IAE3C,OAAOF,KAAK,CAACgB,gBAAgB,CAACD,OAAO,CAACH,MAAM,CAAC;EAC/C,CAAC,CAAC;AACJ;AAEA,OAAM,SAAUM,MAAMA,CAAEX,UAAuB;EAC7C,OAAOA,UAAU,CAACC,MAAM,CAAEC,EAAE,IAAI;IAC9B,IAAIA,EAAE,CAACC,UAAU,EAAE,CAACC,QAAQ,CAACV,YAAY,CAAC,EAAE;MAC1C,OAAO,KAAK;;IAGd,MAAMW,MAAM,GAAGH,EAAE,CAACI,eAAe,CAACX,QAAQ,CAAC;IAE3C,OAAOF,KAAK,CAACgB,gBAAgB,CAACD,OAAO,CAACH,MAAM,CAAC,IAC3CZ,KAAK,CAACmB,GAAG,CAACJ,OAAO,CAACH,MAAM,CAACC,eAAe,CAACV,QAAQ,CAAC,CAACU,eAAe,CAACR,QAAQ,CAAC,CAAC;EACjF,CAAC,CAAC;AACJ;AAEA,OAAM,SAAUe,UAAUA,CAAEb,UAAuB;EACjD,OAAOA,UAAU,CAACC,MAAM,CAAEC,EAAE,IAAI;IAC9B,IAAIA,EAAE,CAACC,UAAU,EAAE,CAACC,QAAQ,CAACV,YAAY,CAAC,EAAE;MAC1C,OAAO,KAAK;;IAGd,MAAMW,MAAM,GAAGH,EAAE,CAACI,eAAe,CAACX,QAAQ,CAAC;IAE3C;IACA,IAAIF,KAAK,CAACc,UAAU,CAACC,OAAO,CAACH,MAAM,CAAC,EAAE;MACpC,OAAOZ,KAAK,CAACmB,GAAG,CAACJ,OAAO,CAACH,MAAM,CAACC,eAAe,CAACV,QAAQ,CAAC,CAACU,eAAe,CAACT,OAAO,CAAC,CAAC;;IAGrF;IACA,OAAOJ,KAAK,CAACgB,gBAAgB,CAACD,OAAO,CAACH,MAAM,CAAC,IAC3CZ,KAAK,CAACmB,GAAG,CAACJ,OAAO,CAACH,MAAM,CAACC,eAAe,CAACV,QAAQ,CAAC,CAACU,eAAe,CAACR,QAAQ,CAAC,CAAC;EACjF,CAAC,CAAC;AACJ"},"metadata":{},"sourceType":"module","externalDependencies":[]}