{"ast":null,"code":"import errCode from 'err-code';\nimport { isStartable } from '@libp2p/interfaces/startable';\nexport class DefaultComponents {\n  constructor(init = {}) {\n    this._started = false;\n    this._peerId = init.peerId;\n    this._addressManager = init.addressManager;\n    this._peerStore = init.peerStore;\n    this._upgrader = init.upgrader;\n    this._metrics = init.metrics;\n    this._registrar = init.registrar;\n    this._connectionManager = init.connectionManager;\n    this._transportManager = init.transportManager;\n    this._connectionGater = init.connectionGater;\n    this._contentRouting = init.contentRouting;\n    this._peerRouting = init.peerRouting;\n    this._datastore = init.datastore;\n    this._connectionProtector = init.connectionProtector;\n    this._dht = init.dht;\n    this._pubsub = init.pubsub;\n    this._dialer = init.dialer;\n  }\n  isStarted() {\n    return this._started;\n  }\n  async beforeStart() {\n    await Promise.all(Object.values(this).filter(obj => isStartable(obj)).map(async startable => {\n      if (startable.beforeStart != null) {\n        await startable.beforeStart();\n      }\n    }));\n  }\n  async start() {\n    await Promise.all(Object.values(this).filter(obj => isStartable(obj)).map(async startable => {\n      await startable.start();\n    }));\n    this._started = true;\n  }\n  async afterStart() {\n    await Promise.all(Object.values(this).filter(obj => isStartable(obj)).map(async startable => {\n      if (startable.afterStart != null) {\n        await startable.afterStart();\n      }\n    }));\n  }\n  async beforeStop() {\n    await Promise.all(Object.values(this).filter(obj => isStartable(obj)).map(async startable => {\n      if (startable.beforeStop != null) {\n        await startable.beforeStop();\n      }\n    }));\n  }\n  async stop() {\n    await Promise.all(Object.values(this).filter(obj => isStartable(obj)).map(async startable => {\n      await startable.stop();\n    }));\n    this._started = false;\n  }\n  async afterStop() {\n    await Promise.all(Object.values(this).filter(obj => isStartable(obj)).map(async startable => {\n      if (startable.afterStop != null) {\n        await startable.afterStop();\n      }\n    }));\n  }\n  get peerId() {\n    if (this._peerId == null) {\n      throw errCode(new Error('peerId not set'), 'ERR_SERVICE_MISSING');\n    }\n    return this._peerId;\n  }\n  set peerId(peerId) {\n    this._peerId = peerId;\n  }\n  get addressManager() {\n    if (this._addressManager == null) {\n      throw errCode(new Error('addressManager not set'), 'ERR_SERVICE_MISSING');\n    }\n    return this._addressManager;\n  }\n  set addressManager(addressManager) {\n    this._addressManager = addressManager;\n  }\n  get peerStore() {\n    if (this._peerStore == null) {\n      throw errCode(new Error('peerStore not set'), 'ERR_SERVICE_MISSING');\n    }\n    return this._peerStore;\n  }\n  set peerStore(peerStore) {\n    this._peerStore = peerStore;\n  }\n  get upgrader() {\n    if (this._upgrader == null) {\n      throw errCode(new Error('upgrader not set'), 'ERR_SERVICE_MISSING');\n    }\n    return this._upgrader;\n  }\n  set upgrader(upgrader) {\n    this._upgrader = upgrader;\n  }\n  get registrar() {\n    if (this._registrar == null) {\n      throw errCode(new Error('registrar not set'), 'ERR_SERVICE_MISSING');\n    }\n    return this._registrar;\n  }\n  set registrar(registrar) {\n    this._registrar = registrar;\n  }\n  get connectionManager() {\n    if (this._connectionManager == null) {\n      throw errCode(new Error('connectionManager not set'), 'ERR_SERVICE_MISSING');\n    }\n    return this._connectionManager;\n  }\n  set connectionManager(connectionManager) {\n    this._connectionManager = connectionManager;\n  }\n  get transportManager() {\n    if (this._transportManager == null) {\n      throw errCode(new Error('transportManager not set'), 'ERR_SERVICE_MISSING');\n    }\n    return this._transportManager;\n  }\n  set transportManager(transportManager) {\n    this._transportManager = transportManager;\n  }\n  get connectionGater() {\n    if (this._connectionGater == null) {\n      throw errCode(new Error('connectionGater not set'), 'ERR_SERVICE_MISSING');\n    }\n    return this._connectionGater;\n  }\n  set connectionGater(connectionGater) {\n    this._connectionGater = connectionGater;\n  }\n  get contentRouting() {\n    if (this._contentRouting == null) {\n      throw errCode(new Error('contentRouting not set'), 'ERR_SERVICE_MISSING');\n    }\n    return this._contentRouting;\n  }\n  set contentRouting(contentRouting) {\n    this._contentRouting = contentRouting;\n  }\n  get peerRouting() {\n    if (this._peerRouting == null) {\n      throw errCode(new Error('peerRouting not set'), 'ERR_SERVICE_MISSING');\n    }\n    return this._peerRouting;\n  }\n  set peerRouting(peerRouting) {\n    this._peerRouting = peerRouting;\n  }\n  get datastore() {\n    if (this._datastore == null) {\n      throw errCode(new Error('datastore not set'), 'ERR_SERVICE_MISSING');\n    }\n    return this._datastore;\n  }\n  set datastore(datastore) {\n    this._datastore = datastore;\n  }\n  get connectionProtector() {\n    return this._connectionProtector;\n  }\n  set connectionProtector(connectionProtector) {\n    this._connectionProtector = connectionProtector;\n  }\n  get dialer() {\n    if (this._dialer == null) {\n      throw errCode(new Error('dialer not set'), 'ERR_SERVICE_MISSING');\n    }\n    return this._dialer;\n  }\n  set dialer(dialer) {\n    this._dialer = dialer;\n  }\n  get metrics() {\n    return this._metrics;\n  }\n  set metrics(metrics) {\n    this._metrics = metrics;\n  }\n  get dht() {\n    return this._dht;\n  }\n  set dht(dht) {\n    this._dht = dht;\n  }\n  get pubsub() {\n    return this._pubsub;\n  }\n  set pubsub(pubsub) {\n    this._pubsub = pubsub;\n  }\n}","map":{"version":3,"names":["errCode","isStartable","DefaultComponents","constructor","init","_started","_peerId","peerId","_addressManager","addressManager","_peerStore","peerStore","_upgrader","upgrader","_metrics","metrics","_registrar","registrar","_connectionManager","connectionManager","_transportManager","transportManager","_connectionGater","connectionGater","_contentRouting","contentRouting","_peerRouting","peerRouting","_datastore","datastore","_connectionProtector","connectionProtector","_dht","dht","_pubsub","pubsub","_dialer","dialer","isStarted","beforeStart","Promise","all","Object","values","filter","obj","map","startable","start","afterStart","beforeStop","stop","afterStop","Error"],"sources":["../../src/components.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}