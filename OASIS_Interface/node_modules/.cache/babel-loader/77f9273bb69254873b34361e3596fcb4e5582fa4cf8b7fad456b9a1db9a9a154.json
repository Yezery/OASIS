{"ast":null,"code":"export default (socket => {\n  // if the socket is closing or closed, return end\n  if (socket.readyState >= 2) {\n    throw new Error('socket closed');\n  }\n  // if open, return\n  if (socket.readyState === 1) {\n    return;\n  }\n  return new Promise((resolve, reject) => {\n    function cleanup() {\n      socket.removeEventListener('open', handleOpen);\n      socket.removeEventListener('error', handleErr);\n    }\n    function handleOpen() {\n      cleanup();\n      resolve();\n    }\n    function handleErr(event) {\n      cleanup();\n      reject(event.error ?? new Error(`connect ECONNREFUSED ${socket.url}`));\n    }\n    socket.addEventListener('open', handleOpen);\n    socket.addEventListener('error', handleErr);\n  });\n});","map":{"version":3,"names":["socket","readyState","Error","Promise","resolve","reject","cleanup","removeEventListener","handleOpen","handleErr","event","error","url","addEventListener"],"sources":["../../src/ready.ts"],"sourcesContent":[null],"mappings":"AAEA,gBAAgBA,MAAiB,IAAI;EACnC;EACA,IAAIA,MAAM,CAACC,UAAU,IAAI,CAAC,EAAE;IAC1B,MAAM,IAAIC,KAAK,CAAC,eAAe,CAAC;;EAGlC;EACA,IAAIF,MAAM,CAACC,UAAU,KAAK,CAAC,EAAE;IAC3B;;EAGF,OAAO,IAAIE,OAAO,CAAO,CAACC,OAAO,EAAEC,MAAM,KAAI;IAC3C,SAASC,OAAOA,CAAA;MACdN,MAAM,CAACO,mBAAmB,CAAC,MAAM,EAAEC,UAAU,CAAC;MAC9CR,MAAM,CAACO,mBAAmB,CAAC,OAAO,EAAEE,SAAS,CAAC;IAChD;IAEA,SAASD,UAAUA,CAAA;MACjBF,OAAO,EAAE;MACTF,OAAO,EAAE;IACX;IAEA,SAASK,SAASA,CAAEC,KAAiB;MACnCJ,OAAO,EAAE;MACTD,MAAM,CAACK,KAAK,CAACC,KAAK,IAAI,IAAIT,KAAK,CAAC,wBAAwBF,MAAM,CAACY,GAAG,EAAE,CAAC,CAAC;IACxE;IAEAZ,MAAM,CAACa,gBAAgB,CAAC,MAAM,EAAEL,UAAU,CAAC;IAC3CR,MAAM,CAACa,gBAAgB,CAAC,OAAO,EAAEJ,SAAS,CAAC;EAC7C,CAAC,CAAC;AACJ,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}