{"ast":null,"code":"import { unmarshalPrivateKey } from '@libp2p/crypto/keys';\nimport { StrictSign, StrictNoSign } from '@libp2p/interface-pubsub';\nimport { PublishConfigType } from '../types.js';\n/**\n * Prepare a PublishConfig object from a PeerId.\n */\nexport async function getPublishConfigFromPeerId(signaturePolicy, peerId) {\n  switch (signaturePolicy) {\n    case StrictSign:\n      {\n        if (!peerId) {\n          throw Error('Must provide PeerId');\n        }\n        if (peerId.privateKey == null) {\n          throw Error('Cannot sign message, no private key present');\n        }\n        if (peerId.publicKey == null) {\n          throw Error('Cannot sign message, no public key present');\n        }\n        // Transform privateKey once at initialization time instead of once per message\n        const privateKey = await unmarshalPrivateKey(peerId.privateKey);\n        return {\n          type: PublishConfigType.Signing,\n          author: peerId,\n          key: peerId.publicKey,\n          privateKey\n        };\n      }\n    case StrictNoSign:\n      return {\n        type: PublishConfigType.Anonymous\n      };\n    default:\n      throw new Error(`Unknown signature policy \"${signaturePolicy}\"`);\n  }\n}","map":{"version":3,"names":["unmarshalPrivateKey","StrictSign","StrictNoSign","PublishConfigType","getPublishConfigFromPeerId","signaturePolicy","peerId","Error","privateKey","publicKey","type","Signing","author","key","Anonymous"],"sources":["../../../src/utils/publishConfig.ts"],"sourcesContent":[null],"mappings":"AAAA,SAASA,mBAAmB,QAAQ,qBAAqB;AACzD,SAASC,UAAU,EAAEC,YAAY,QAAQ,0BAA0B;AAEnE,SAAwBC,iBAAiB,QAAQ,aAAa;AAE9D;;;AAGA,OAAO,eAAeC,0BAA0BA,CAC9CC,eAAwD,EACxDC,MAAe;EAEf,QAAQD,eAAe;IACrB,KAAKJ,UAAU;MAAE;QACf,IAAI,CAACK,MAAM,EAAE;UACX,MAAMC,KAAK,CAAC,qBAAqB,CAAC;;QAGpC,IAAID,MAAM,CAACE,UAAU,IAAI,IAAI,EAAE;UAC7B,MAAMD,KAAK,CAAC,6CAA6C,CAAC;;QAG5D,IAAID,MAAM,CAACG,SAAS,IAAI,IAAI,EAAE;UAC5B,MAAMF,KAAK,CAAC,4CAA4C,CAAC;;QAG3D;QACA,MAAMC,UAAU,GAAG,MAAMR,mBAAmB,CAACM,MAAM,CAACE,UAAU,CAAC;QAE/D,OAAO;UACLE,IAAI,EAAEP,iBAAiB,CAACQ,OAAO;UAC/BC,MAAM,EAAEN,MAAM;UACdO,GAAG,EAAEP,MAAM,CAACG,SAAS;UACrBD;SACD;;IAGH,KAAKN,YAAY;MACf,OAAO;QACLQ,IAAI,EAAEP,iBAAiB,CAACW;OACzB;IAEH;MACE,MAAM,IAAIP,KAAK,CAAC,6BAA6BF,eAAe,GAAG,CAAC;;AAEtE"},"metadata":{},"sourceType":"module","externalDependencies":[]}