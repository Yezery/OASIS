{"ast":null,"code":"import { CID } from 'multiformats/cid';\nimport * as dagPb from '@ipld/dag-pb';\nimport { sha256 } from 'multiformats/hashes/sha2';\n\n/**\n * @param {Uint8Array} buffer\n * @param {import('interface-blockstore').Blockstore} blockstore\n * @param {import('../types').PersistOptions} options\n */\nconst persist = async (buffer, blockstore, options) => {\n  if (!options.codec) {\n    options.codec = dagPb;\n  }\n  if (!options.hasher) {\n    options.hasher = sha256;\n  }\n  if (options.cidVersion === undefined) {\n    options.cidVersion = 1;\n  }\n  if (options.codec === dagPb && options.hasher !== sha256) {\n    options.cidVersion = 1;\n  }\n  const multihash = await options.hasher.digest(buffer);\n  const cid = CID.create(options.cidVersion, options.codec.code, multihash);\n  if (!options.onlyHash) {\n    await blockstore.put(cid, buffer, {\n      signal: options.signal\n    });\n  }\n  return cid;\n};\nexport default persist;","map":{"version":3,"names":["CID","dagPb","sha256","persist","buffer","blockstore","options","codec","hasher","cidVersion","undefined","multihash","digest","cid","create","code","onlyHash","put","signal"],"sources":["/Users/yezery/Oasis/OASIS/node_modules/.store/ipfs-unixfs-importer@12.0.1/node_modules/ipfs-unixfs-importer/src/utils/persist.js"],"sourcesContent":["import { CID } from 'multiformats/cid'\nimport * as dagPb from '@ipld/dag-pb'\nimport { sha256 } from 'multiformats/hashes/sha2'\n\n/**\n * @param {Uint8Array} buffer\n * @param {import('interface-blockstore').Blockstore} blockstore\n * @param {import('../types').PersistOptions} options\n */\nconst persist = async (buffer, blockstore, options) => {\n  if (!options.codec) {\n    options.codec = dagPb\n  }\n\n  if (!options.hasher) {\n    options.hasher = sha256\n  }\n\n  if (options.cidVersion === undefined) {\n    options.cidVersion = 1\n  }\n\n  if (options.codec === dagPb && options.hasher !== sha256) {\n    options.cidVersion = 1\n  }\n\n  const multihash = await options.hasher.digest(buffer)\n  const cid = CID.create(options.cidVersion, options.codec.code, multihash)\n\n  if (!options.onlyHash) {\n    await blockstore.put(cid, buffer, {\n      signal: options.signal\n    })\n  }\n\n  return cid\n}\n\nexport default persist\n"],"mappings":"AAAA,SAASA,GAAG,QAAQ,kBAAkB;AACtC,OAAO,KAAKC,KAAK,MAAM,cAAc;AACrC,SAASC,MAAM,QAAQ,0BAA0B;;AAEjD;AACA;AACA;AACA;AACA;AACA,MAAMC,OAAO,GAAG,MAAAA,CAAOC,MAAM,EAAEC,UAAU,EAAEC,OAAO,KAAK;EACrD,IAAI,CAACA,OAAO,CAACC,KAAK,EAAE;IAClBD,OAAO,CAACC,KAAK,GAAGN,KAAK;EACvB;EAEA,IAAI,CAACK,OAAO,CAACE,MAAM,EAAE;IACnBF,OAAO,CAACE,MAAM,GAAGN,MAAM;EACzB;EAEA,IAAII,OAAO,CAACG,UAAU,KAAKC,SAAS,EAAE;IACpCJ,OAAO,CAACG,UAAU,GAAG,CAAC;EACxB;EAEA,IAAIH,OAAO,CAACC,KAAK,KAAKN,KAAK,IAAIK,OAAO,CAACE,MAAM,KAAKN,MAAM,EAAE;IACxDI,OAAO,CAACG,UAAU,GAAG,CAAC;EACxB;EAEA,MAAME,SAAS,GAAG,MAAML,OAAO,CAACE,MAAM,CAACI,MAAM,CAACR,MAAM,CAAC;EACrD,MAAMS,GAAG,GAAGb,GAAG,CAACc,MAAM,CAACR,OAAO,CAACG,UAAU,EAAEH,OAAO,CAACC,KAAK,CAACQ,IAAI,EAAEJ,SAAS,CAAC;EAEzE,IAAI,CAACL,OAAO,CAACU,QAAQ,EAAE;IACrB,MAAMX,UAAU,CAACY,GAAG,CAACJ,GAAG,EAAET,MAAM,EAAE;MAChCc,MAAM,EAAEZ,OAAO,CAACY;IAClB,CAAC,CAAC;EACJ;EAEA,OAAOL,GAAG;AACZ,CAAC;AAED,eAAeV,OAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}