{"ast":null,"code":"require(\"core-js/modules/es.array.push.js\");\nconst RateLimiterAbstract = require('./RateLimiterAbstract');\nmodule.exports = class RateLimiterUnion {\n  constructor(...limiters) {\n    if (limiters.length < 1) {\n      throw new Error('RateLimiterUnion: at least one limiter have to be passed');\n    }\n    limiters.forEach(limiter => {\n      if (!(limiter instanceof RateLimiterAbstract)) {\n        throw new Error('RateLimiterUnion: all limiters have to be instance of RateLimiterAbstract');\n      }\n    });\n    this._limiters = limiters;\n  }\n  consume(key, points = 1) {\n    return new Promise((resolve, reject) => {\n      const promises = [];\n      this._limiters.forEach(limiter => {\n        promises.push(limiter.consume(key, points).catch(rej => ({\n          rejected: true,\n          rej\n        })));\n      });\n      Promise.all(promises).then(res => {\n        const resObj = {};\n        let rejected = false;\n        res.forEach(item => {\n          if (item.rejected === true) {\n            rejected = true;\n          }\n        });\n        for (let i = 0; i < res.length; i++) {\n          if (rejected && res[i].rejected === true) {\n            resObj[this._limiters[i].keyPrefix] = res[i].rej;\n          } else if (!rejected) {\n            resObj[this._limiters[i].keyPrefix] = res[i];\n          }\n        }\n        if (rejected) {\n          reject(resObj);\n        } else {\n          resolve(resObj);\n        }\n      });\n    });\n  }\n};","map":{"version":3,"names":["RateLimiterAbstract","require","module","exports","RateLimiterUnion","constructor","limiters","length","Error","forEach","limiter","_limiters","consume","key","points","Promise","resolve","reject","promises","push","catch","rej","rejected","all","then","res","resObj","item","i","keyPrefix"],"sources":["/Users/yezery/Oasis/OASIS/node_modules/.store/rate-limiter-flexible@2.4.2/node_modules/rate-limiter-flexible/lib/RateLimiterUnion.js"],"sourcesContent":["const RateLimiterAbstract = require('./RateLimiterAbstract');\n\nmodule.exports = class RateLimiterUnion {\n  constructor(...limiters) {\n    if (limiters.length < 1) {\n      throw new Error('RateLimiterUnion: at least one limiter have to be passed');\n    }\n    limiters.forEach((limiter) => {\n      if (!(limiter instanceof RateLimiterAbstract)) {\n        throw new Error('RateLimiterUnion: all limiters have to be instance of RateLimiterAbstract');\n      }\n    });\n\n    this._limiters = limiters;\n  }\n\n  consume(key, points = 1) {\n    return new Promise((resolve, reject) => {\n      const promises = [];\n      this._limiters.forEach((limiter) => {\n        promises.push(limiter.consume(key, points).catch(rej => ({ rejected: true, rej })));\n      });\n\n      Promise.all(promises)\n        .then((res) => {\n          const resObj = {};\n          let rejected = false;\n\n          res.forEach((item) => {\n            if (item.rejected === true) {\n              rejected = true;\n            }\n          });\n\n          for (let i = 0; i < res.length; i++) {\n            if (rejected && res[i].rejected === true) {\n              resObj[this._limiters[i].keyPrefix] = res[i].rej;\n            } else if (!rejected) {\n              resObj[this._limiters[i].keyPrefix] = res[i];\n            }\n          }\n\n          if (rejected) {\n            reject(resObj);\n          } else {\n            resolve(resObj);\n          }\n        });\n    });\n  }\n};\n"],"mappings":";AAAA,MAAMA,mBAAmB,GAAGC,OAAO,CAAC,uBAAuB,CAAC;AAE5DC,MAAM,CAACC,OAAO,GAAG,MAAMC,gBAAgB,CAAC;EACtCC,WAAWA,CAAC,GAAGC,QAAQ,EAAE;IACvB,IAAIA,QAAQ,CAACC,MAAM,GAAG,CAAC,EAAE;MACvB,MAAM,IAAIC,KAAK,CAAC,0DAA0D,CAAC;IAC7E;IACAF,QAAQ,CAACG,OAAO,CAAEC,OAAO,IAAK;MAC5B,IAAI,EAAEA,OAAO,YAAYV,mBAAmB,CAAC,EAAE;QAC7C,MAAM,IAAIQ,KAAK,CAAC,2EAA2E,CAAC;MAC9F;IACF,CAAC,CAAC;IAEF,IAAI,CAACG,SAAS,GAAGL,QAAQ;EAC3B;EAEAM,OAAOA,CAACC,GAAG,EAAEC,MAAM,GAAG,CAAC,EAAE;IACvB,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;MACtC,MAAMC,QAAQ,GAAG,EAAE;MACnB,IAAI,CAACP,SAAS,CAACF,OAAO,CAAEC,OAAO,IAAK;QAClCQ,QAAQ,CAACC,IAAI,CAACT,OAAO,CAACE,OAAO,CAACC,GAAG,EAAEC,MAAM,CAAC,CAACM,KAAK,CAACC,GAAG,KAAK;UAAEC,QAAQ,EAAE,IAAI;UAAED;QAAI,CAAC,CAAC,CAAC,CAAC;MACrF,CAAC,CAAC;MAEFN,OAAO,CAACQ,GAAG,CAACL,QAAQ,CAAC,CAClBM,IAAI,CAAEC,GAAG,IAAK;QACb,MAAMC,MAAM,GAAG,CAAC,CAAC;QACjB,IAAIJ,QAAQ,GAAG,KAAK;QAEpBG,GAAG,CAAChB,OAAO,CAAEkB,IAAI,IAAK;UACpB,IAAIA,IAAI,CAACL,QAAQ,KAAK,IAAI,EAAE;YAC1BA,QAAQ,GAAG,IAAI;UACjB;QACF,CAAC,CAAC;QAEF,KAAK,IAAIM,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGH,GAAG,CAAClB,MAAM,EAAEqB,CAAC,EAAE,EAAE;UACnC,IAAIN,QAAQ,IAAIG,GAAG,CAACG,CAAC,CAAC,CAACN,QAAQ,KAAK,IAAI,EAAE;YACxCI,MAAM,CAAC,IAAI,CAACf,SAAS,CAACiB,CAAC,CAAC,CAACC,SAAS,CAAC,GAAGJ,GAAG,CAACG,CAAC,CAAC,CAACP,GAAG;UAClD,CAAC,MAAM,IAAI,CAACC,QAAQ,EAAE;YACpBI,MAAM,CAAC,IAAI,CAACf,SAAS,CAACiB,CAAC,CAAC,CAACC,SAAS,CAAC,GAAGJ,GAAG,CAACG,CAAC,CAAC;UAC9C;QACF;QAEA,IAAIN,QAAQ,EAAE;UACZL,MAAM,CAACS,MAAM,CAAC;QAChB,CAAC,MAAM;UACLV,OAAO,CAACU,MAAM,CAAC;QACjB;MACF,CAAC,CAAC;IACN,CAAC,CAAC;EACJ;AACF,CAAC"},"metadata":{},"sourceType":"script","externalDependencies":[]}