{"ast":null,"code":"import \"core-js/modules/es.typed-array.to-reversed.js\";\nimport \"core-js/modules/es.typed-array.to-sorted.js\";\nimport \"core-js/modules/es.typed-array.with.js\";\nimport { Uint8ArrayList } from 'uint8arraylist';\nimport { unsigned } from 'uint8-varint';\nimport { allocUnsafe } from './alloc.js';\nconst defaultEncoder = length => {\n  const lengthLength = unsigned.encodingLength(length);\n  const lengthBuf = allocUnsafe(lengthLength);\n  unsigned.encode(length, lengthBuf);\n  defaultEncoder.bytes = lengthLength;\n  return lengthBuf;\n};\ndefaultEncoder.bytes = 0;\nexport function encode(options) {\n  options = options ?? {};\n  const encodeLength = options.lengthEncoder ?? defaultEncoder;\n  const encoder = async function* (source) {\n    for await (const chunk of source) {\n      // length + data\n      const length = encodeLength(chunk.byteLength);\n      // yield only Uint8Arrays\n      if (length instanceof Uint8Array) {\n        yield length;\n      } else {\n        yield* length;\n      }\n      // yield only Uint8Arrays\n      if (chunk instanceof Uint8Array) {\n        yield chunk;\n      } else {\n        yield* chunk;\n      }\n    }\n  };\n  return encoder;\n}\nencode.single = (chunk, options) => {\n  options = options ?? {};\n  const encodeLength = options.lengthEncoder ?? defaultEncoder;\n  return new Uint8ArrayList(encodeLength(chunk.byteLength), chunk);\n};","map":{"version":3,"names":["Uint8ArrayList","unsigned","allocUnsafe","defaultEncoder","length","lengthLength","encodingLength","lengthBuf","encode","bytes","options","encodeLength","lengthEncoder","encoder","source","chunk","byteLength","Uint8Array","single"],"sources":["../../src/encode.ts"],"sourcesContent":[null],"mappings":";;;AAAA,SAASA,cAAc,QAAQ,gBAAgB;AAC/C,SAASC,QAAQ,QAAQ,cAAc;AAGvC,SAASC,WAAW,QAAQ,YAAY;AAMxC,MAAMC,cAAc,GAA2BC,MAAM,IAAI;EACvD,MAAMC,YAAY,GAAGJ,QAAQ,CAACK,cAAc,CAACF,MAAM,CAAC;EACpD,MAAMG,SAAS,GAAGL,WAAW,CAACG,YAAY,CAAC;EAE3CJ,QAAQ,CAACO,MAAM,CAACJ,MAAM,EAAEG,SAAS,CAAC;EAElCJ,cAAc,CAACM,KAAK,GAAGJ,YAAY;EAEnC,OAAOE,SAAS;AAClB,CAAC;AACDJ,cAAc,CAACM,KAAK,GAAG,CAAC;AAExB,OAAM,SAAUD,MAAMA,CAAEE,OAAwB;EAC9CA,OAAO,GAAGA,OAAO,IAAI,EAAE;EAEvB,MAAMC,YAAY,GAAGD,OAAO,CAACE,aAAa,IAAIT,cAAc;EAE5D,MAAMU,OAAO,GAAG,gBAAAA,CAAkBC,MAA2C;IAC3E,WAAW,MAAMC,KAAK,IAAID,MAAM,EAAE;MAChC;MACA,MAAMV,MAAM,GAAGO,YAAY,CAACI,KAAK,CAACC,UAAU,CAAC;MAE7C;MACA,IAAIZ,MAAM,YAAYa,UAAU,EAAE;QAChC,MAAMb,MAAM;OACb,MAAM;QACL,OAAQA,MAAM;;MAGhB;MACA,IAAIW,KAAK,YAAYE,UAAU,EAAE;QAC/B,MAAMF,KAAK;OACZ,MAAM;QACL,OAAQA,KAAK;;;EAGnB,CAAC;EAED,OAAOF,OAAO;AAChB;AAEAL,MAAM,CAACU,MAAM,GAAG,CAACH,KAAkC,EAAEL,OAAwB,KAAI;EAC/EA,OAAO,GAAGA,OAAO,IAAI,EAAE;EACvB,MAAMC,YAAY,GAAGD,OAAO,CAACE,aAAa,IAAIT,cAAc;EAE5D,OAAO,IAAIH,cAAc,CACvBW,YAAY,CAACI,KAAK,CAACC,UAAU,CAAC,EAC9BD,KAAK,CACN;AACH,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}