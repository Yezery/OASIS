{"ast":null,"code":"'use strict';\n\nconst {\n  AbstractKeyIterator,\n  AbstractValueIterator\n} = require('../abstract-iterator');\nconst kIterator = Symbol('iterator');\nconst kCallback = Symbol('callback');\nconst kHandleOne = Symbol('handleOne');\nconst kHandleMany = Symbol('handleMany');\nclass DefaultKeyIterator extends AbstractKeyIterator {\n  constructor(db, options) {\n    super(db, options);\n    this[kIterator] = db.iterator({\n      ...options,\n      keys: true,\n      values: false\n    });\n    this[kHandleOne] = this[kHandleOne].bind(this);\n    this[kHandleMany] = this[kHandleMany].bind(this);\n  }\n}\nclass DefaultValueIterator extends AbstractValueIterator {\n  constructor(db, options) {\n    super(db, options);\n    this[kIterator] = db.iterator({\n      ...options,\n      keys: false,\n      values: true\n    });\n    this[kHandleOne] = this[kHandleOne].bind(this);\n    this[kHandleMany] = this[kHandleMany].bind(this);\n  }\n}\nfor (const Iterator of [DefaultKeyIterator, DefaultValueIterator]) {\n  const keys = Iterator === DefaultKeyIterator;\n  const mapEntry = keys ? entry => entry[0] : entry => entry[1];\n  Iterator.prototype._next = function (callback) {\n    this[kCallback] = callback;\n    this[kIterator].next(this[kHandleOne]);\n  };\n  Iterator.prototype[kHandleOne] = function (err, key, value) {\n    const callback = this[kCallback];\n    if (err) callback(err);else callback(null, keys ? key : value);\n  };\n  Iterator.prototype._nextv = function (size, options, callback) {\n    this[kCallback] = callback;\n    this[kIterator].nextv(size, options, this[kHandleMany]);\n  };\n  Iterator.prototype._all = function (options, callback) {\n    this[kCallback] = callback;\n    this[kIterator].all(options, this[kHandleMany]);\n  };\n  Iterator.prototype[kHandleMany] = function (err, entries) {\n    const callback = this[kCallback];\n    if (err) callback(err);else callback(null, entries.map(mapEntry));\n  };\n  Iterator.prototype._seek = function (target, options) {\n    this[kIterator].seek(target, options);\n  };\n  Iterator.prototype._close = function (callback) {\n    this[kIterator].close(callback);\n  };\n}\n\n// Internal utilities, should be typed as AbstractKeyIterator and AbstractValueIterator\nexports.DefaultKeyIterator = DefaultKeyIterator;\nexports.DefaultValueIterator = DefaultValueIterator;","map":{"version":3,"names":["AbstractKeyIterator","AbstractValueIterator","require","kIterator","Symbol","kCallback","kHandleOne","kHandleMany","DefaultKeyIterator","constructor","db","options","iterator","keys","values","bind","DefaultValueIterator","Iterator","mapEntry","entry","prototype","_next","callback","next","err","key","value","_nextv","size","nextv","_all","all","entries","map","_seek","target","seek","_close","close","exports"],"sources":["/Users/yezery/Oasis/OASIS/node_modules/.store/abstract-level@1.0.3/node_modules/abstract-level/lib/default-kv-iterator.js"],"sourcesContent":["'use strict'\n\nconst { AbstractKeyIterator, AbstractValueIterator } = require('../abstract-iterator')\n\nconst kIterator = Symbol('iterator')\nconst kCallback = Symbol('callback')\nconst kHandleOne = Symbol('handleOne')\nconst kHandleMany = Symbol('handleMany')\n\nclass DefaultKeyIterator extends AbstractKeyIterator {\n  constructor (db, options) {\n    super(db, options)\n\n    this[kIterator] = db.iterator({ ...options, keys: true, values: false })\n    this[kHandleOne] = this[kHandleOne].bind(this)\n    this[kHandleMany] = this[kHandleMany].bind(this)\n  }\n}\n\nclass DefaultValueIterator extends AbstractValueIterator {\n  constructor (db, options) {\n    super(db, options)\n\n    this[kIterator] = db.iterator({ ...options, keys: false, values: true })\n    this[kHandleOne] = this[kHandleOne].bind(this)\n    this[kHandleMany] = this[kHandleMany].bind(this)\n  }\n}\n\nfor (const Iterator of [DefaultKeyIterator, DefaultValueIterator]) {\n  const keys = Iterator === DefaultKeyIterator\n  const mapEntry = keys ? (entry) => entry[0] : (entry) => entry[1]\n\n  Iterator.prototype._next = function (callback) {\n    this[kCallback] = callback\n    this[kIterator].next(this[kHandleOne])\n  }\n\n  Iterator.prototype[kHandleOne] = function (err, key, value) {\n    const callback = this[kCallback]\n    if (err) callback(err)\n    else callback(null, keys ? key : value)\n  }\n\n  Iterator.prototype._nextv = function (size, options, callback) {\n    this[kCallback] = callback\n    this[kIterator].nextv(size, options, this[kHandleMany])\n  }\n\n  Iterator.prototype._all = function (options, callback) {\n    this[kCallback] = callback\n    this[kIterator].all(options, this[kHandleMany])\n  }\n\n  Iterator.prototype[kHandleMany] = function (err, entries) {\n    const callback = this[kCallback]\n    if (err) callback(err)\n    else callback(null, entries.map(mapEntry))\n  }\n\n  Iterator.prototype._seek = function (target, options) {\n    this[kIterator].seek(target, options)\n  }\n\n  Iterator.prototype._close = function (callback) {\n    this[kIterator].close(callback)\n  }\n}\n\n// Internal utilities, should be typed as AbstractKeyIterator and AbstractValueIterator\nexports.DefaultKeyIterator = DefaultKeyIterator\nexports.DefaultValueIterator = DefaultValueIterator\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}