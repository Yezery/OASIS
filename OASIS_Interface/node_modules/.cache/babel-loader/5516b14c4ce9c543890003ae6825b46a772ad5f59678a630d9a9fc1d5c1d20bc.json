{"ast":null,"code":"import \"core-js/modules/es.typed-array.to-reversed.js\";\nimport \"core-js/modules/es.typed-array.to-sorted.js\";\nimport \"core-js/modules/es.typed-array.with.js\";\nimport { concat as uint8ArrayConcat } from 'uint8arrays/concat';\nconst allocUnsafe = len => {\n  if (globalThis.Buffer) {\n    return globalThis.Buffer.allocUnsafe(len);\n  }\n  return new Uint8Array(len);\n};\nexport const uint16BEEncode = value => {\n  const target = allocUnsafe(2);\n  new DataView(target.buffer, target.byteOffset, target.byteLength).setUint16(0, value, false);\n  return target;\n};\nuint16BEEncode.bytes = 2;\nexport const uint16BEDecode = data => {\n  if (data.length < 2) throw RangeError('Could not decode int16BE');\n  if (data instanceof Uint8Array) {\n    return new DataView(data.buffer, data.byteOffset, data.byteLength).getUint16(0, false);\n  }\n  return data.getUint16(0);\n};\nuint16BEDecode.bytes = 2;\n// Note: IK and XX encoder usage is opposite (XX uses in stages encode0 where IK uses encode1)\nexport function encode0(message) {\n  return uint8ArrayConcat([message.ne, message.ciphertext], message.ne.length + message.ciphertext.length);\n}\nexport function encode1(message) {\n  return uint8ArrayConcat([message.ne, message.ns, message.ciphertext], message.ne.length + message.ns.length + message.ciphertext.length);\n}\nexport function encode2(message) {\n  return uint8ArrayConcat([message.ns, message.ciphertext], message.ns.length + message.ciphertext.length);\n}\nexport function decode0(input) {\n  if (input.length < 32) {\n    throw new Error('Cannot decode stage 0 MessageBuffer: length less than 32 bytes.');\n  }\n  return {\n    ne: input.subarray(0, 32),\n    ciphertext: input.subarray(32, input.length),\n    ns: new Uint8Array(0)\n  };\n}\nexport function decode1(input) {\n  if (input.length < 80) {\n    throw new Error('Cannot decode stage 1 MessageBuffer: length less than 80 bytes.');\n  }\n  return {\n    ne: input.subarray(0, 32),\n    ns: input.subarray(32, 80),\n    ciphertext: input.subarray(80, input.length)\n  };\n}\nexport function decode2(input) {\n  if (input.length < 48) {\n    throw new Error('Cannot decode stage 2 MessageBuffer: length less than 48 bytes.');\n  }\n  return {\n    ne: new Uint8Array(0),\n    ns: input.subarray(0, 48),\n    ciphertext: input.subarray(48, input.length)\n  };\n}","map":{"version":3,"names":["concat","uint8ArrayConcat","allocUnsafe","len","globalThis","Buffer","Uint8Array","uint16BEEncode","value","target","DataView","buffer","byteOffset","byteLength","setUint16","bytes","uint16BEDecode","data","length","RangeError","getUint16","encode0","message","ne","ciphertext","encode1","ns","encode2","decode0","input","Error","subarray","decode1","decode2"],"sources":["../../src/encoder.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}