{"ast":null,"code":"'use strict';\n\nconst {\n  AbstractIterator,\n  AbstractKeyIterator,\n  AbstractValueIterator\n} = require('../abstract-iterator');\nconst kUnfix = Symbol('unfix');\nconst kIterator = Symbol('iterator');\nconst kHandleOne = Symbol('handleOne');\nconst kHandleMany = Symbol('handleMany');\nconst kCallback = Symbol('callback');\n\n// TODO: unfix natively if db supports it\nclass AbstractSublevelIterator extends AbstractIterator {\n  constructor(db, options, iterator, unfix) {\n    super(db, options);\n    this[kIterator] = iterator;\n    this[kUnfix] = unfix;\n    this[kHandleOne] = this[kHandleOne].bind(this);\n    this[kHandleMany] = this[kHandleMany].bind(this);\n    this[kCallback] = null;\n  }\n  [kHandleOne](err, key, value) {\n    const callback = this[kCallback];\n    if (err) return callback(err);\n    if (key !== undefined) key = this[kUnfix](key);\n    callback(err, key, value);\n  }\n  [kHandleMany](err, entries) {\n    const callback = this[kCallback];\n    if (err) return callback(err);\n    for (const entry of entries) {\n      const key = entry[0];\n      if (key !== undefined) entry[0] = this[kUnfix](key);\n    }\n    callback(err, entries);\n  }\n}\nclass AbstractSublevelKeyIterator extends AbstractKeyIterator {\n  constructor(db, options, iterator, unfix) {\n    super(db, options);\n    this[kIterator] = iterator;\n    this[kUnfix] = unfix;\n    this[kHandleOne] = this[kHandleOne].bind(this);\n    this[kHandleMany] = this[kHandleMany].bind(this);\n    this[kCallback] = null;\n  }\n  [kHandleOne](err, key) {\n    const callback = this[kCallback];\n    if (err) return callback(err);\n    if (key !== undefined) key = this[kUnfix](key);\n    callback(err, key);\n  }\n  [kHandleMany](err, keys) {\n    const callback = this[kCallback];\n    if (err) return callback(err);\n    for (let i = 0; i < keys.length; i++) {\n      const key = keys[i];\n      if (key !== undefined) keys[i] = this[kUnfix](key);\n    }\n    callback(err, keys);\n  }\n}\nclass AbstractSublevelValueIterator extends AbstractValueIterator {\n  constructor(db, options, iterator) {\n    super(db, options);\n    this[kIterator] = iterator;\n  }\n}\nfor (const Iterator of [AbstractSublevelIterator, AbstractSublevelKeyIterator]) {\n  Iterator.prototype._next = function (callback) {\n    this[kCallback] = callback;\n    this[kIterator].next(this[kHandleOne]);\n  };\n  Iterator.prototype._nextv = function (size, options, callback) {\n    this[kCallback] = callback;\n    this[kIterator].nextv(size, options, this[kHandleMany]);\n  };\n  Iterator.prototype._all = function (options, callback) {\n    this[kCallback] = callback;\n    this[kIterator].all(options, this[kHandleMany]);\n  };\n}\nfor (const Iterator of [AbstractSublevelValueIterator]) {\n  Iterator.prototype._next = function (callback) {\n    this[kIterator].next(callback);\n  };\n  Iterator.prototype._nextv = function (size, options, callback) {\n    this[kIterator].nextv(size, options, callback);\n  };\n  Iterator.prototype._all = function (options, callback) {\n    this[kIterator].all(options, callback);\n  };\n}\nfor (const Iterator of [AbstractSublevelIterator, AbstractSublevelKeyIterator, AbstractSublevelValueIterator]) {\n  Iterator.prototype._seek = function (target, options) {\n    this[kIterator].seek(target, options);\n  };\n  Iterator.prototype._close = function (callback) {\n    this[kIterator].close(callback);\n  };\n}\nexports.AbstractSublevelIterator = AbstractSublevelIterator;\nexports.AbstractSublevelKeyIterator = AbstractSublevelKeyIterator;\nexports.AbstractSublevelValueIterator = AbstractSublevelValueIterator;","map":{"version":3,"names":["AbstractIterator","AbstractKeyIterator","AbstractValueIterator","require","kUnfix","Symbol","kIterator","kHandleOne","kHandleMany","kCallback","AbstractSublevelIterator","constructor","db","options","iterator","unfix","bind","err","key","value","callback","undefined","entries","entry","AbstractSublevelKeyIterator","keys","i","length","AbstractSublevelValueIterator","Iterator","prototype","_next","next","_nextv","size","nextv","_all","all","_seek","target","seek","_close","close","exports"],"sources":["/Users/yezery/Oasis/OASIS/node_modules/.store/abstract-level@1.0.3/node_modules/abstract-level/lib/abstract-sublevel-iterator.js"],"sourcesContent":["'use strict'\n\nconst { AbstractIterator, AbstractKeyIterator, AbstractValueIterator } = require('../abstract-iterator')\n\nconst kUnfix = Symbol('unfix')\nconst kIterator = Symbol('iterator')\nconst kHandleOne = Symbol('handleOne')\nconst kHandleMany = Symbol('handleMany')\nconst kCallback = Symbol('callback')\n\n// TODO: unfix natively if db supports it\nclass AbstractSublevelIterator extends AbstractIterator {\n  constructor (db, options, iterator, unfix) {\n    super(db, options)\n\n    this[kIterator] = iterator\n    this[kUnfix] = unfix\n    this[kHandleOne] = this[kHandleOne].bind(this)\n    this[kHandleMany] = this[kHandleMany].bind(this)\n    this[kCallback] = null\n  }\n\n  [kHandleOne] (err, key, value) {\n    const callback = this[kCallback]\n    if (err) return callback(err)\n    if (key !== undefined) key = this[kUnfix](key)\n    callback(err, key, value)\n  }\n\n  [kHandleMany] (err, entries) {\n    const callback = this[kCallback]\n    if (err) return callback(err)\n\n    for (const entry of entries) {\n      const key = entry[0]\n      if (key !== undefined) entry[0] = this[kUnfix](key)\n    }\n\n    callback(err, entries)\n  }\n}\n\nclass AbstractSublevelKeyIterator extends AbstractKeyIterator {\n  constructor (db, options, iterator, unfix) {\n    super(db, options)\n\n    this[kIterator] = iterator\n    this[kUnfix] = unfix\n    this[kHandleOne] = this[kHandleOne].bind(this)\n    this[kHandleMany] = this[kHandleMany].bind(this)\n    this[kCallback] = null\n  }\n\n  [kHandleOne] (err, key) {\n    const callback = this[kCallback]\n    if (err) return callback(err)\n    if (key !== undefined) key = this[kUnfix](key)\n    callback(err, key)\n  }\n\n  [kHandleMany] (err, keys) {\n    const callback = this[kCallback]\n    if (err) return callback(err)\n\n    for (let i = 0; i < keys.length; i++) {\n      const key = keys[i]\n      if (key !== undefined) keys[i] = this[kUnfix](key)\n    }\n\n    callback(err, keys)\n  }\n}\n\nclass AbstractSublevelValueIterator extends AbstractValueIterator {\n  constructor (db, options, iterator) {\n    super(db, options)\n    this[kIterator] = iterator\n  }\n}\n\nfor (const Iterator of [AbstractSublevelIterator, AbstractSublevelKeyIterator]) {\n  Iterator.prototype._next = function (callback) {\n    this[kCallback] = callback\n    this[kIterator].next(this[kHandleOne])\n  }\n\n  Iterator.prototype._nextv = function (size, options, callback) {\n    this[kCallback] = callback\n    this[kIterator].nextv(size, options, this[kHandleMany])\n  }\n\n  Iterator.prototype._all = function (options, callback) {\n    this[kCallback] = callback\n    this[kIterator].all(options, this[kHandleMany])\n  }\n}\n\nfor (const Iterator of [AbstractSublevelValueIterator]) {\n  Iterator.prototype._next = function (callback) {\n    this[kIterator].next(callback)\n  }\n\n  Iterator.prototype._nextv = function (size, options, callback) {\n    this[kIterator].nextv(size, options, callback)\n  }\n\n  Iterator.prototype._all = function (options, callback) {\n    this[kIterator].all(options, callback)\n  }\n}\n\nfor (const Iterator of [AbstractSublevelIterator, AbstractSublevelKeyIterator, AbstractSublevelValueIterator]) {\n  Iterator.prototype._seek = function (target, options) {\n    this[kIterator].seek(target, options)\n  }\n\n  Iterator.prototype._close = function (callback) {\n    this[kIterator].close(callback)\n  }\n}\n\nexports.AbstractSublevelIterator = AbstractSublevelIterator\nexports.AbstractSublevelKeyIterator = AbstractSublevelKeyIterator\nexports.AbstractSublevelValueIterator = AbstractSublevelValueIterator\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}