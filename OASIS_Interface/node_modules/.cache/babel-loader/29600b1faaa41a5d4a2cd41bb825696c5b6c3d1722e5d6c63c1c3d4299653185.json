{"ast":null,"code":"// @ts-expect-error no types\nimport ReaderClass from 'protobufjs/src/reader.js';\n// @ts-expect-error no types\nimport ReaderBufferClass from 'protobufjs/src/reader_buffer.js';\n// @ts-expect-error no types\nimport util from 'protobufjs/src/util/minimal.js';\n// @ts-expect-error no types\nimport WriterClass from 'protobufjs/src/writer.js';\n// @ts-expect-error no types\nimport WriterBufferClass from 'protobufjs/src/writer_buffer.js';\nfunction configure() {\n  util._configure();\n  ReaderClass._configure(ReaderBufferClass);\n  WriterClass._configure(WriterBufferClass);\n}\n// Set up buffer utility according to the environment\nconfigure();\n// monkey patch the reader to add native bigint support\nconst methods = ['uint64', 'int64', 'sint64', 'fixed64', 'sfixed64'];\nfunction patchReader(obj) {\n  for (const method of methods) {\n    if (obj[method] == null) {\n      continue;\n    }\n    const original = obj[method];\n    obj[method] = function () {\n      return BigInt(original.call(this).toString());\n    };\n  }\n  return obj;\n}\nexport function reader(buf) {\n  return patchReader(new ReaderClass(buf));\n}\nfunction patchWriter(obj) {\n  for (const method of methods) {\n    if (obj[method] == null) {\n      continue;\n    }\n    const original = obj[method];\n    obj[method] = function (val) {\n      return original.call(this, val.toString());\n    };\n  }\n  return obj;\n}\nexport function writer() {\n  return patchWriter(WriterClass.create());\n}","map":{"version":3,"names":["ReaderClass","ReaderBufferClass","util","WriterClass","WriterBufferClass","configure","_configure","methods","patchReader","obj","method","original","BigInt","call","toString","reader","buf","patchWriter","val","writer","create"],"sources":["../../src/utils.ts"],"sourcesContent":[null],"mappings":"AAAA;AACA,OAAOA,WAAW,MAAM,0BAA0B;AAClD;AACA,OAAOC,iBAAiB,MAAM,iCAAiC;AAC/D;AACA,OAAOC,IAAI,MAAM,gCAAgC;AACjD;AACA,OAAOC,WAAW,MAAM,0BAA0B;AAClD;AACA,OAAOC,iBAAiB,MAAM,iCAAiC;AAG/D,SAASC,SAASA,CAAA;EAChBH,IAAI,CAACI,UAAU,EAAE;EACjBN,WAAW,CAACM,UAAU,CAACL,iBAAiB,CAAC;EACzCE,WAAW,CAACG,UAAU,CAACF,iBAAiB,CAAC;AAC3C;AAEA;AACAC,SAAS,EAAE;AAEX;AACA,MAAME,OAAO,GAAG,CACd,QAAQ,EAAE,OAAO,EAAE,QAAQ,EAAE,SAAS,EAAE,UAAU,CACnD;AAED,SAASC,WAAWA,CAAEC,GAAQ;EAC5B,KAAK,MAAMC,MAAM,IAAIH,OAAO,EAAE;IAC5B,IAAIE,GAAG,CAACC,MAAM,CAAC,IAAI,IAAI,EAAE;MACvB;;IAGF,MAAMC,QAAQ,GAAGF,GAAG,CAACC,MAAM,CAAC;IAC5BD,GAAG,CAACC,MAAM,CAAC,GAAG;MACZ,OAAOE,MAAM,CAACD,QAAQ,CAACE,IAAI,CAAC,IAAI,CAAC,CAACC,QAAQ,EAAE,CAAC;IAC/C,CAAC;;EAGH,OAAOL,GAAG;AACZ;AAEA,OAAM,SAAUM,MAAMA,CAAEC,GAAe;EACrC,OAAOR,WAAW,CAAC,IAAIR,WAAW,CAACgB,GAAG,CAAC,CAAC;AAC1C;AAEA,SAASC,WAAWA,CAAER,GAAQ;EAC5B,KAAK,MAAMC,MAAM,IAAIH,OAAO,EAAE;IAC5B,IAAIE,GAAG,CAACC,MAAM,CAAC,IAAI,IAAI,EAAE;MACvB;;IAGF,MAAMC,QAAQ,GAAGF,GAAG,CAACC,MAAM,CAAC;IAC5BD,GAAG,CAACC,MAAM,CAAC,GAAG,UAAUQ,GAAW;MACjC,OAAOP,QAAQ,CAACE,IAAI,CAAC,IAAI,EAAEK,GAAG,CAACJ,QAAQ,EAAE,CAAC;IAC5C,CAAC;;EAGH,OAAOL,GAAG;AACZ;AAEA,OAAM,SAAUU,MAAMA,CAAA;EACpB,OAAOF,WAAW,CAACd,WAAW,CAACiB,MAAM,EAAE,CAAC;AAC1C"},"metadata":{},"sourceType":"module","externalDependencies":[]}