{"ast":null,"code":"import request from \"@/utils/axiosRequest\";\nimport store from '@/store';\nimport { create } from \"ipfs-http-client\";\nimport Web3 from 'web3';\nimport { updateSaleactive, insertSale, deleteSale, makeNewTransaction } from \"./Sale\";\nimport { postOwnerContractList, getOwnerUpSaleNFTs, updateNFTOwnerListAfterBuy } from \"./ownerContractLIst\";\nimport { mintNFTContractABI, mintNFTContractBytecode, marketContractAddress, marketContractABI, ipfsPublicGatewayUrl, rpcUrl } from \"@/contract/Contract\";\n//  IPFS的根URL\n// const baseURL = ipfsBaseURI();\n//  铸币合约ABI\nconst MintNFTContractABI = mintNFTContractABI();\n//  铸币合约ByteCode\nconst MintNFTContractBytecode = mintNFTContractBytecode();\n//  市场合约地址\nconst MarketContractAddress = marketContractAddress();\n//  市场合约ABI\nconst MarketContractABI = marketContractABI();\n// 指定其他节点的 IP 和端口\n// const peerAddress = ipfsPeerAddress()\n//  IPFS网关\nconst publicGatewayUrl = ipfsPublicGatewayUrl();\n// 服务器IP\nconst IP = store.state.IP;\n\n//====================  部署铸造NFT合约，返回NFT合约实例 \nasync function deployNFTContract(Name, Symbol, Maxmums) {\n  let contract = new store.state.Web3.eth.Contract(MintNFTContractABI);\n  //  部署合约\n  let NewNFTContractAddress = await contract.deploy({\n    data: MintNFTContractBytecode,\n    arguments: [Name, Symbol, publicGatewayUrl, Maxmums]\n  }).send({\n    from: store.state.currentAddress\n  });\n  console.log(NewNFTContractAddress._address);\n  //  通过部署合约返回的合约地址，与合约ABI产生合约实例\n  let NFTContract = await new store.state.Web3.eth.Contract(MintNFTContractABI, NewNFTContractAddress._address);\n  return NFTContract;\n}\n//====================  保存到IPFS，返回IPFS哈希值\nasync function savetoIPFS(uploadFiles) {\n  try {\n    if (uploadFiles.length != 0) {\n      //ipfs的add方法是将东西添加到ipfs网络上\n      let results = await create({\n        host: `${IP}`,\n        port: \"5001\",\n        protocol: \"http\"\n      }).add(uploadFiles[0].raw, {\n        remote: true,\n        pin: true\n      });\n      return results.path;\n    }\n  } catch (err) {\n    console.error(err);\n    return null;\n  }\n}\n\n// \nasync function mintNFT(NFTContract, name, symbol, maxmums, NFTName, description, uploadFiles) {\n  let nftCount = 0;\n  let ipfsHash = await savetoIPFS(uploadFiles);\n  let ipfsPath = `ipfs/${ipfsHash}?filename=${NFTName}`;\n  if (ipfsHash != null) {\n    try {\n      await NFTContract.methods._currentId().call().then(re => {\n        nftCount = re;\n      });\n    } catch (error) {\n      console.log(error);\n      console.log(NFTContract.methods);\n    }\n    await NFTContract.methods.mint(NFTName, description, ipfsHash).send({\n      from: store.state.currentAddress\n    });\n    await AddNewNFTToMetaMask(NFTContract._address, nftCount, symbol, `${publicGatewayUrl}${ipfsPath}`);\n    // // ====================  信息存储到数据库中\n    await request({\n      url: '/createNFT',\n      method: 'post',\n      data: {\n        \"ownerAddress\": store.state.currentAddress,\n        \"currentOwner\": store.state.currentAddress,\n        \"nftAddress\": NFTContract._address,\n        \"ipfsPath\": `${publicGatewayUrl}${ipfsPath}`,\n        \"isActive\": false,\n        \"price\": \"0\",\n        \"seriesName\": name,\n        \"symbol\": symbol,\n        \"nftName\": NFTName,\n        \"maxmums\": Number(maxmums),\n        \"description\": description,\n        \"tokenId\": Number(nftCount)\n      }\n    }).then(res => {\n      if (res.status == 200) {\n        postOwnerContractList({\n          ownerAddress: store.state.currentAddress\n        }).then(re => {\n          store.commit(\"setOwnerNFTList\", re.data.data);\n        });\n        return;\n      } else {\n        return;\n      }\n    });\n  }\n}\nexport async function addMint(to, nftAddress, NFTName, description, uploadFiles, seriesName, symbol, maxmums) {\n  let nftCount = 0;\n  let ipfsHash = await savetoIPFS(uploadFiles);\n  let ipfsPath = `ipfs/${ipfsHash}?filename=${NFTName}`;\n  let contract = await getNFTStruct(nftAddress);\n  if (ipfsHash != null) {\n    try {\n      await contract.methods._currentId().call().then(re => {\n        nftCount = re;\n      });\n    } catch (error) {\n      console.log(error);\n    }\n    await contract.methods.giveMint(to, NFTName, description, ipfsHash).send({\n      from: store.state.currentAddress\n    });\n    // // ====================  信息存储到数据库中\n    await request({\n      url: '/createNFT',\n      method: 'post',\n      data: {\n        \"ownerAddress\": to,\n        \"currentOwner\": store.state.currentAddress,\n        \"nftAddress\": contract._address,\n        \"ipfsPath\": `${publicGatewayUrl}${ipfsPath}`,\n        \"isActive\": false,\n        \"price\": \"0\",\n        \"seriesName\": seriesName,\n        \"symbol\": symbol,\n        \"nftName\": NFTName,\n        \"maxmums\": Number(maxmums),\n        \"description\": description,\n        \"tokenId\": Number(nftCount)\n      }\n    }).then(res => {\n      if (res.status == 200) {\n        postOwnerContractList({\n          ownerAddress: store.state.currentAddress\n        }).then(re => {\n          store.commit(\"setOwnerNFTList\", re.data.data);\n        });\n        return;\n      } else {\n        return;\n      }\n    });\n  }\n}\n\n//====================  生成NFT合约实例\nexport async function getNFTStruct(nftAddress) {\n  return await new store.state.Web3.eth.Contract(MintNFTContractABI, nftAddress);\n}\n\n//==================== NFT总控\nexport async function MakeNFT(Name, Symbol, uploadFiles, Maxmums, FirstNFTName, Description) {\n  console.log(\"部署合约\");\n  const NFTContract = await deployNFTContract(Name, Symbol, Maxmums);\n  console.log(\"铸造\");\n  await mintNFT(NFTContract, Name, Symbol, Maxmums, FirstNFTName, Description, uploadFiles);\n}\n//====================  市场合约\nlet MarketContract;\nlet marketUseWeb3;\n// 实例化市场合约\n\nconsole.log(\"初始化WEB3......\");\nif (window.ethereum != undefined) {\n  marketUseWeb3 = new Web3(window.ethereum);\n  store.commit(\"setWEB3\", new Web3(window.ethereum));\n  console.log(\"初始化WEB3(MetaMask)完毕\");\n} else {\n  marketUseWeb3 = new Web3(rpcUrl());\n  store.commit(\"setWEB3\", new Web3(rpcUrl()));\n  console.log(\"初始化WEB3(RPC)完毕\");\n}\nMarketContract = new marketUseWeb3.eth.Contract(MarketContractABI, MarketContractAddress);\n//====================  上架NFT\nexport async function getSaleList() {\n  let SaleList = [];\n  try {\n    await MarketContract.methods.getSales().call().then(re => {\n      SaleList = re;\n    });\n  } catch (error) {\n    console.log(error);\n  }\n  return SaleList;\n}\nexport async function UpSale(NFT) {\n  let SaleId;\n  try {\n    //授权\n    let NFTContract = await new store.state.Web3.eth.Contract(MintNFTContractABI, NFT.nftAddress);\n    await NFTContract.methods.approve(MarketContractAddress, NFT.tokenId).send({\n      from: store.state.currentAddress\n    });\n    await MarketContract.methods.createSale(NFT.nftAddress, NFT.tokenId, store.state.Web3.utils.toWei(NFT.price, 'ether'), \"\").send({\n      from: store.state.currentAddress\n    });\n    await MarketContract.methods.getSalesId().call().then(re => {\n      SaleId = re;\n    });\n    var Sale = {\n      saleId: Number(SaleId),\n      NFTOwnerList: NFT\n    };\n    await insertSale(Sale);\n    NFT.isActive = true;\n    NFT.price = store.state.Web3.utils.toWei(NFT.price, 'ether');\n    await updateSaleactive(NFT);\n    await postOwnerContractList({\n      ownerAddress: store.state.currentAddress\n    }).then(re => {\n      store.commit(\"setOwnerNFTList\", re.data.data);\n    });\n    return true;\n  } catch (error) {\n    console.log(error);\n    return false;\n  }\n}\nexport async function DownSale(NFT) {\n  let SaleId;\n  try {\n    await getOwnerUpSaleNFTs(NFT).then(re => {\n      SaleId = re.data.data.saleId;\n    });\n    if (SaleId != undefined) {\n      await MarketContract.methods.cancelSale(SaleId).send({\n        from: store.state.currentAddress\n      });\n      NFT.isActive = false;\n      NFT.price = \"0\";\n      NFT.saleId = SaleId;\n      await updateSaleactive(NFT);\n      await deleteSale(NFT);\n      await postOwnerContractList({\n        ownerAddress: store.state.currentAddress\n      }).then(re => {\n        store.commit(\"setOwnerNFTList\", re.data.data);\n      });\n      return true;\n    } else {\n      return false;\n    }\n  } catch (error) {\n    console.log(error);\n    return false;\n  }\n}\nexport async function Buy(NFT) {\n  try {\n    await MarketContract.methods.buy(NFT.saleId).send({\n      from: store.state.currentAddress,\n      value: store.state.Web3.utils.toWei(NFT.price, 'ether')\n    });\n    await AddNewNFTToMetaMask(NFT.nftAddress, NFT.tokenId.toString(), NFT.symbol, NFT.image);\n    NFT.isActive = false;\n    NFT.currentOwner = store.state.currentAddress;\n    await updateNFTOwnerListAfterBuy(NFT);\n    await deleteSale(NFT);\n    await postOwnerContractList({\n      ownerAddress: store.state.currentAddress\n    }).then(re => {\n      store.commit(\"setOwnerNFTList\", re.data.data);\n    });\n    await makeNewTransaction({\n      turnover: store.state.Web3.utils.toWei(NFT.price, 'ether'),\n      timestamp: new Date().toISOString()\n    });\n    return true;\n  } catch (error) {\n    console.log(error);\n    return false;\n  }\n}\nexport async function getFeePercentage() {\n  let FeePercentage;\n  await MarketContract.methods.feePercentage().call().then(re => {\n    FeePercentage = re;\n  });\n  return FeePercentage;\n}\nexport async function AddNewNFTToMetaMask(address, tokenId, symbol, image) {\n  await window.ethereum.request({\n    method: 'wallet_watchAsset',\n    params: {\n      type: 'ERC721',\n      options: {\n        address: address,\n        tokenId: tokenId,\n        symbol: symbol,\n        image: JSON.stringify(image)\n      }\n    }\n  }).then(success => {\n    if (success) {\n      console.log(`${JSON.stringify(symbol)} successfully added to wallet!`);\n    } else {\n      throw new Error('Something went wrong.');\n    }\n  }).catch(console.error);\n}","map":{"version":3,"names":["request","store","create","Web3","updateSaleactive","insertSale","deleteSale","makeNewTransaction","postOwnerContractList","getOwnerUpSaleNFTs","updateNFTOwnerListAfterBuy","mintNFTContractABI","mintNFTContractBytecode","marketContractAddress","marketContractABI","ipfsPublicGatewayUrl","rpcUrl","MintNFTContractABI","MintNFTContractBytecode","MarketContractAddress","MarketContractABI","publicGatewayUrl","IP","state","deployNFTContract","Name","Symbol","Maxmums","contract","eth","Contract","NewNFTContractAddress","deploy","data","arguments","send","from","currentAddress","console","log","_address","NFTContract","savetoIPFS","uploadFiles","length","results","host","port","protocol","add","raw","remote","pin","path","err","error","mintNFT","name","symbol","maxmums","NFTName","description","nftCount","ipfsHash","ipfsPath","methods","_currentId","call","then","re","mint","AddNewNFTToMetaMask","url","method","Number","res","status","ownerAddress","commit","addMint","to","nftAddress","seriesName","getNFTStruct","giveMint","MakeNFT","FirstNFTName","Description","MarketContract","marketUseWeb3","window","ethereum","undefined","getSaleList","SaleList","getSales","UpSale","NFT","SaleId","approve","tokenId","createSale","utils","toWei","price","getSalesId","Sale","saleId","NFTOwnerList","isActive","DownSale","cancelSale","Buy","buy","value","toString","image","currentOwner","turnover","timestamp","Date","toISOString","getFeePercentage","FeePercentage","feePercentage","address","params","type","options","JSON","stringify","success","Error","catch"],"sources":["/Users/yezery/OASIS/OASIS_Interface/src/api/axios/contract.js"],"sourcesContent":["import request from \"@/utils/axiosRequest\"\nimport store from '@/store';\nimport { create } from \"ipfs-http-client\"\nimport Web3 from 'web3'\nimport { updateSaleactive, insertSale, deleteSale,makeNewTransaction } from \"./Sale\"\nimport { postOwnerContractList, getOwnerUpSaleNFTs, updateNFTOwnerListAfterBuy } from \"./ownerContractLIst\";\nimport { mintNFTContractABI, mintNFTContractBytecode, marketContractAddress, marketContractABI, ipfsPublicGatewayUrl, rpcUrl } from \"@/contract/Contract\"\n//  IPFS的根URL\n// const baseURL = ipfsBaseURI();\n//  铸币合约ABI\nconst MintNFTContractABI = mintNFTContractABI()\n//  铸币合约ByteCode\nconst MintNFTContractBytecode = mintNFTContractBytecode()\n//  市场合约地址\nconst MarketContractAddress = marketContractAddress();\n//  市场合约ABI\nconst MarketContractABI = marketContractABI();\n// 指定其他节点的 IP 和端口\n// const peerAddress = ipfsPeerAddress()\n//  IPFS网关\nconst publicGatewayUrl = ipfsPublicGatewayUrl();\n// 服务器IP\nconst IP = store.state.IP\n\n//====================  部署铸造NFT合约，返回NFT合约实例 \nasync function deployNFTContract(Name, Symbol, Maxmums) {\n  let contract = new store.state.Web3.eth.Contract(MintNFTContractABI);\n  //  部署合约\n  let NewNFTContractAddress = await contract.deploy({ data: MintNFTContractBytecode, arguments: [Name, Symbol, publicGatewayUrl, Maxmums] })\n    .send({\n      from: store.state.currentAddress\n    });\n  console.log(NewNFTContractAddress._address);\n  //  通过部署合约返回的合约地址，与合约ABI产生合约实例\n  let NFTContract = await new store.state.Web3.eth.Contract(MintNFTContractABI, NewNFTContractAddress._address);\n  return NFTContract;\n}\n//====================  保存到IPFS，返回IPFS哈希值\nasync function savetoIPFS(uploadFiles) {\n  try {\n    if (uploadFiles.length != 0) {\n      //ipfs的add方法是将东西添加到ipfs网络上\n      let results = await create({\n        host: `${IP}`,\n        port: \"5001\",\n        protocol: \"http\",\n      }).add(\n        uploadFiles[0].raw,\n        { remote: true, pin: true, }\n      );\n      return results.path;\n    }\n  } catch (err) {\n    console.error(err);\n    return null\n  }\n}\n\n// \nasync function mintNFT(NFTContract, name, symbol, maxmums, NFTName, description, uploadFiles) {\n  let nftCount = 0\n  let ipfsHash = await savetoIPFS(uploadFiles)\n  let ipfsPath = `ipfs/${ipfsHash}?filename=${NFTName}`\n  if (ipfsHash != null) {\n    try {\n      await NFTContract.methods._currentId().call().then(re => { nftCount = re })\n    } catch (error) {\n      console.log(error);\n      console.log(NFTContract.methods);\n    }\n    await NFTContract.methods.mint(NFTName, description, ipfsHash).send({ from: store.state.currentAddress })\n    await AddNewNFTToMetaMask(NFTContract._address, nftCount, symbol, `${publicGatewayUrl}${ipfsPath}`)\n    // // ====================  信息存储到数据库中\n    await request({\n      url: '/createNFT',\n      method: 'post',\n      data: {\n        \"ownerAddress\": store.state.currentAddress,\n        \"currentOwner\": store.state.currentAddress,\n        \"nftAddress\": NFTContract._address,\n        \"ipfsPath\": `${publicGatewayUrl}${ipfsPath}`,\n        \"isActive\": false,\n        \"price\": \"0\",\n        \"seriesName\": name,\n        \"symbol\": symbol,\n        \"nftName\": NFTName,\n        \"maxmums\": Number(maxmums),\n        \"description\": description,\n        \"tokenId\": Number(nftCount)\n      }\n    }).then(res => {\n      if (res.status == 200) {\n        postOwnerContractList({ ownerAddress: store.state.currentAddress }).then((re) => {\n          store.commit(\"setOwnerNFTList\", re.data.data);\n        });\n        return\n      } else {\n        return\n      }\n    })\n  }\n}\nexport async function addMint(to, nftAddress, NFTName, description, uploadFiles, seriesName, symbol, maxmums) {\n  let nftCount = 0\n  let ipfsHash = await savetoIPFS(uploadFiles)\n  let ipfsPath = `ipfs/${ipfsHash}?filename=${NFTName}`\n  let contract = await getNFTStruct(nftAddress)\n  if (ipfsHash != null) {\n    try {\n      await contract.methods._currentId().call().then(re => { nftCount = re })\n    } catch (error) {\n      console.log(error);\n    }\n    await contract.methods.giveMint(to, NFTName, description, ipfsHash).send({ from: store.state.currentAddress })\n    // // ====================  信息存储到数据库中\n    await request({\n      url: '/createNFT',\n      method: 'post',\n      data: {\n        \"ownerAddress\": to,\n        \"currentOwner\": store.state.currentAddress,\n        \"nftAddress\": contract._address,\n        \"ipfsPath\": `${publicGatewayUrl}${ipfsPath}`,\n        \"isActive\": false,\n        \"price\": \"0\",\n        \"seriesName\": seriesName,\n        \"symbol\": symbol,\n        \"nftName\": NFTName,\n        \"maxmums\": Number(maxmums),\n        \"description\": description,\n        \"tokenId\": Number(nftCount)\n      }\n    }).then(res => {\n      if (res.status == 200) {\n        postOwnerContractList({ ownerAddress: store.state.currentAddress }).then((re) => {\n          store.commit(\"setOwnerNFTList\", re.data.data);\n        });\n        return\n      } else {\n        return\n      }\n    })\n  }\n}\n\n//====================  生成NFT合约实例\nexport async function getNFTStruct(nftAddress) {\n  return await new store.state.Web3.eth.Contract(MintNFTContractABI, nftAddress);\n}\n\n//==================== NFT总控\nexport async function MakeNFT(Name, Symbol, uploadFiles, Maxmums, FirstNFTName, Description) {\n  console.log(\"部署合约\");\n  const NFTContract = await deployNFTContract(Name, Symbol, Maxmums);\n  console.log(\"铸造\");\n  await mintNFT(NFTContract, Name, Symbol, Maxmums, FirstNFTName, Description, uploadFiles)\n\n}\n//====================  市场合约\nlet MarketContract;\nlet marketUseWeb3;\n// 实例化市场合约\n\nconsole.log(\"初始化WEB3......\");\nif (window.ethereum != undefined) {\n  marketUseWeb3 = new Web3(window.ethereum);\n  store.commit(\"setWEB3\", new Web3(window.ethereum));\n  console.log(\"初始化WEB3(MetaMask)完毕\");\n} else {\n  marketUseWeb3 = new Web3(rpcUrl());\n  store.commit(\"setWEB3\", new Web3(rpcUrl()));\n  console.log(\"初始化WEB3(RPC)完毕\");\n}\n\nMarketContract = new marketUseWeb3.eth.Contract(\n  MarketContractABI,\n  MarketContractAddress\n);\n//====================  上架NFT\nexport async function getSaleList() {\n  let SaleList = []\n  try {\n    await MarketContract.methods.getSales().call().then(re => {\n      SaleList = re\n    });\n  } catch (error) {\n    console.log(error);\n  }\n  return SaleList\n}\n\nexport async function UpSale(NFT) {\n  let SaleId;\n  try {\n    //授权\n    let NFTContract = await new store.state.Web3.eth.Contract(\n      MintNFTContractABI,\n      NFT.nftAddress\n    );\n    await NFTContract.methods\n      .approve(MarketContractAddress, NFT.tokenId)\n      .send({ from: store.state.currentAddress });\n    await MarketContract.methods.createSale(NFT.nftAddress, NFT.tokenId, store.state.Web3.utils.toWei(NFT.price, 'ether')\n      , \"\").send({ from: store.state.currentAddress })\n    await MarketContract.methods.getSalesId().call().then(re => {\n      SaleId = re\n    })\n    var Sale = {\n      saleId: Number(SaleId),\n      NFTOwnerList: NFT\n    }\n    await insertSale(Sale)\n    NFT.isActive = true\n    NFT.price = store.state.Web3.utils.toWei(NFT.price, 'ether')\n    await updateSaleactive(NFT)\n    await postOwnerContractList({ ownerAddress: store.state.currentAddress }).then((re) => {\n      store.commit(\"setOwnerNFTList\", re.data.data);\n    });\n    return true\n  } catch (error) {\n    console.log(error);\n    return false\n  }\n\n}\n\nexport async function DownSale(NFT) {\n  let SaleId;\n  try {\n    await getOwnerUpSaleNFTs(NFT).then(re => { SaleId = re.data.data.saleId; })\n    if (SaleId != undefined) {\n      await MarketContract.methods.cancelSale(SaleId)\n        .send({\n          from: store.state.currentAddress\n        });\n      NFT.isActive = false\n      NFT.price = \"0\"\n      NFT.saleId = SaleId\n      await updateSaleactive(NFT)\n      await deleteSale(NFT)\n      await postOwnerContractList({ ownerAddress: store.state.currentAddress }).then((re) => {\n        store.commit(\"setOwnerNFTList\", re.data.data);\n      });\n      return true\n    } else {\n      return false\n    }\n  } catch (error) {\n    console.log(error);\n    return false\n  }\n}\n\n\nexport async function Buy(NFT) {\n  try {\n    await MarketContract.methods.buy(NFT.saleId)\n      .send({\n        from: store.state.currentAddress,\n        value: store.state.Web3.utils.toWei(NFT.price, 'ether'),\n      });\n    await AddNewNFTToMetaMask(NFT.nftAddress, NFT.tokenId.toString(), NFT.symbol, NFT.image)\n    NFT.isActive = false\n    NFT.currentOwner = store.state.currentAddress\n    await updateNFTOwnerListAfterBuy(NFT)\n    await deleteSale(NFT)\n    await postOwnerContractList({ ownerAddress: store.state.currentAddress }).then((re) => {\n      store.commit(\"setOwnerNFTList\", re.data.data);\n    });\n    await makeNewTransaction({\n      turnover: store.state.Web3.utils.toWei(NFT.price, 'ether'),\n      timestamp: new Date().toISOString() \n    })\n    return true\n  } catch (error) {\n    console.log(error);\n    return false\n  }\n\n}\n\nexport async function getFeePercentage() {\n  let FeePercentage;\n  await MarketContract.methods.feePercentage().call().then(re => { FeePercentage = re })\n  return FeePercentage;\n}\n\nexport async function AddNewNFTToMetaMask(address, tokenId, symbol, image) {\n\n  await window.ethereum\n    .request({\n      method: 'wallet_watchAsset',\n      params: {\n        type: 'ERC721',\n        options: {\n          address: address,\n          tokenId: tokenId,\n          symbol: symbol,\n          image: JSON.stringify(image),\n        },\n      },\n    })\n    .then((success) => {\n      if (success) {\n        console.log(`${JSON.stringify(symbol)} successfully added to wallet!`);\n      } else {\n        throw new Error('Something went wrong.');\n      }\n    })\n    .catch(console.error);\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}