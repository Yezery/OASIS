{"ast":null,"code":"import { process } from \"@/utils/nsfwjs\";\nimport { getNFTStruct } from \"@/api/axios/contract\";\nimport { addMint } from \"@/api/axios/contract\";\nexport default {\n  data() {\n    return {\n      imageUrl: \"\",\n      dialogImageUrl: \"\",\n      dialogVisible: false,\n      disabled: false,\n      fileList: [],\n      seriesName: \"\",\n      symbol: \"\",\n      nftContractAddress: \"\",\n      Description: \"\",\n      maximums: 0,\n      NFTName: \"\",\n      to: this.$store.state.currentAddress,\n      sumitEnable: true,\n      isRepeatClick: true,\n      isProcess: false,\n      processLoading: false,\n      noProcess: false,\n      isChanging: false\n    };\n  },\n  async mounted() {\n    this.nftContractAddress = this.$route.query.nftContract;\n    await this.init();\n  },\n  computed: {\n    canSubmit() {\n      if (this.seriesName == \"\" || this.symbol == \"\" || this.$refs.pictureUpload.uploadFiles.length == 0 || this.NFTName == \"\" || !this.isProcess || this.Description == '3D') {\n        return false;\n      } else {\n        return true;\n      }\n    }\n  },\n  watch: {\n    Description(newData) {\n      if (newData == '3D') {\n        this.$notify({\n          title: \"不能为关键字\",\n          type: \"warning\",\n          position: \"top-left\",\n          offset: 200\n        });\n        this.Description = '';\n      }\n    }\n  },\n  methods: {\n    async setPicture() {\n      if (this.$refs.pictureUpload.uploadFiles.length == 1) {\n        this.processLoading = true;\n        setTimeout(async () => {\n          console.log(this.$refs.realPicture);\n          await process(this.$refs.realPicture).then(re => {\n            this.processLoading = false;\n            if (re[0].className == \"Neutral\" && re[0].probability > 0.8 || re[0].className == \"Drawing\" && re[0].probability > 0.8) {\n              this.isProcess = true;\n            } else {\n              this.isProcess = false;\n              this.noProcess = true;\n            }\n          });\n        }, 500);\n      }\n    },\n    async init() {\n      let contract = await getNFTStruct(this.nftContractAddress);\n      await contract.methods.symbol().call().then(re => {\n        this.symbol = re;\n      });\n      await contract.methods.name().call().then(re => {\n        this.seriesName = re;\n      });\n      await contract.methods._maximums().call().then(re => {\n        this.maximums = re;\n      });\n    },\n    async addMint() {\n      if (this.isRepeatClick) {\n        this.isRepeatClick = false;\n        if (this.$refs.pictureUpload.uploadFiles[0].raw.type == \"image/jepg\" || this.$refs.pictureUpload.uploadFiles[0].raw.type == \"image/png\" || this.$refs.pictureUpload.uploadFiles[0].raw.type == \"image/jpg\") {\n          try {\n            this.isChanging = true;\n            await addMint(this.to, this.nftContractAddress, this.NFTName, this.Description, this.$refs.pictureUpload.uploadFiles, this.seriesName, this.symbol, this.maximums);\n            this.isChanging = false;\n            this.$notify({\n              title: \"添加成功\",\n              type: \"success\",\n              position: \"top-left\",\n              offset: 200\n            });\n            this.fileList = [];\n            this.NFTName = \"\";\n            this.maximums = 1;\n            this.Description = \"\";\n          } catch (error) {\n            this.isChanging = false;\n            this.$notify.error({\n              title: \"添加失败\",\n              position: \"top-left\",\n              offset: 200\n            });\n          }\n        } else {\n          this.$notify({\n            title: \"NFT格式不支持\",\n            type: \"warning\",\n            position: \"top-left\",\n            offset: 200\n          });\n        }\n      } else {\n        this.$notify({\n          title: \"请勿操作频繁\",\n          type: \"warning\",\n          position: \"top-left\",\n          offset: 200\n        });\n      }\n      setTimeout(() => {\n        this.isRepeatClick = true;\n      }, 5000);\n    },\n    handleRemove(file) {\n      let uploadFiles = this.$refs.pictureUpload.uploadFiles;\n      for (var i = 0; i < uploadFiles.length; i++) {\n        if (uploadFiles[i][\"url\"] == file.url) {\n          uploadFiles.splice(i, 1);\n        }\n      }\n      this.isProcess = false;\n      this.noProcess = false;\n    }\n  }\n};","map":{"version":3,"names":["process","getNFTStruct","addMint","data","imageUrl","dialogImageUrl","dialogVisible","disabled","fileList","seriesName","symbol","nftContractAddress","Description","maximums","NFTName","to","$store","state","currentAddress","sumitEnable","isRepeatClick","isProcess","processLoading","noProcess","isChanging","mounted","$route","query","nftContract","init","computed","canSubmit","$refs","pictureUpload","uploadFiles","length","watch","newData","$notify","title","type","position","offset","methods","setPicture","setTimeout","console","log","realPicture","then","re","className","probability","contract","call","name","_maximums","raw","error","handleRemove","file","i","url","splice"],"sources":["src/views/main/mint/addMintNFT.vue"],"sourcesContent":["<template>\n  <div\n    class=\"MainWindow animate__animated animate__fadeInRight\"\n    v-loading.fullscreen.lock=\"isChanging\"\n    element-loading-text=\"交易进行中\"\n    element-loading-spinner=\"el-icon-loading\"\n    element-loading-background=\"rgba(0, 0, 0, 0.8)\"\n  >\n    <div class=\"mintNFTFrame \">\n      <div class=\"mintNFTFrameTop\">\n        <div class=\"addMintHome_backHome\">\n        <el-button\n          icon=\"el-icon-back\"\n          circle\n          @click=\"$router.back(-1)\"\n        />\n      </div>\n        <div class=\"mintTitle\">\n          Add NFT to your collection\n        </div>\n        <div class=\"mintNFTFrameTop_tipsBox\">\n          为你的系列增加NFT\n        </div>\n      </div>\n      <div class=\"mintNFTFrameMain\">\n        <div class=\"mintNFTFrameMain_left\">\n          <div style=\"text-align: left;margin-bottom: 2%;\">\n            <span\n              style=\"color: black;font-weight: 800;font-size: 0.7vw;\"\n              v-if=\"processLoading\"\n            ><i class=\"el-icon-loading\" />审核中...</span>\n            <span\n              style=\"color: black;font-weight: 800;font-size: 0.7vw;\"\n              v-if=\"isProcess&&!processLoading\"\n            ><i\n              class=\"el-icon-success\"\n              style=\"color: rgb(1, 169, 1);\"\n            /> 图片合规</span>\n            <span\n              style=\"color: red;font-weight: 800;font-size: 0.7vw;\"\n              v-else-if=\"!isProcess&&!processLoading&&noProcess\"\n            ><i class=\"el-icon-error\" /> 图片不合规</span>\n          </div>\n          <!-- <div class=\"imageUpLoad\">\n            <el-upload\n              action=\"#\"\n              list-type=\"picture-card\"\n              ref=\"pictureUpload\"\n              :file-list=\"fileList\"\n              :on-change=\"setPicture\"\n              :auto-upload=\"false\"\n            >\n              <i\n                slot=\"default\"\n                class=\"el-icon-picture\"\n                style=\"\n              font-size: 82px;\n              color: var(--Dark--);\n              transition: all 0.3s ease-in-out;\n            \"\n              />\n              <div\n                slot=\"file\"\n                slot-scope=\"{ file }\"\n              >\n                <img\n                  class=\"el-upload-list__item-thumbnail\"\n                  :src=\"file.url\"\n                  alt=\"\"\n                  ref=\"realPicture\"\n                >\n                <span class=\"el-upload-list__item-actions\">\n                  <span\n                    v-if=\"!disabled\"\n                    class=\"el-upload-list__item-delete\"\n                    @click=\"handleRemove(file)\"\n                  >\n                    <i class=\"el-icon-delete\" />\n                  </span>\n                </span>\n              </div>\n            </el-upload>\n            <div style=\"margin-top: 3%;text-align: center\">\n              <span style=\"color: red\">*</span><span style=\"color: var(--Dark--);font-weight: 800;font-size: 0.2vw;\">支持 JPG、PNG、JEPG 格式</span>\n            </div>\n          </div> -->\n          <div class=\"imageUpLoad\">\n            <el-upload\n              action=\"#\"\n              list-type=\"picture-card\"\n              ref=\"pictureUpload\"\n              :file-list=\"fileList\"\n              :on-change=\"setPicture\"\n              :auto-upload=\"false\"\n            >\n             <div class=\"innerBox\" v-if=\"!isUpload\">\n              <i\n              \n                class=\"el-icon-upload2\"\n                style=\"\n              font-size: 3vw;\n              color: var(--Dark--);\n              transition: all 0.3s ease-in-out;\n              margin-bottom:15px;\n            \"\n              />\n              <div style=\"color: var(--Dark--);font-weight: 800;font-size: 1.2vw;\">\n                将文件拖到此处，或</div>\n                <div style=\"color: #2081E2;font-weight: 800;font-size: 1.2vw;\">\n                点击浏览文件上传</div>\n                <div style=\"color: #B3B3B3;font-weight: 300;font-size: 1vw;\">\n                Max size: 50MB</div>\n               <div style=\"color: #B3B3B3;font-weight: 300;font-size: 1vw;\">\n                JPG,PNG,JEPG,GIF</div>\n            </div> \n              <div\n                slot=\"file\"\n                slot-scope=\"{ file }\"\n              >\n                <img\n                  class=\"el-upload-list__item-thumbnail\"\n                  :src=\"file.url\"\n                  alt=\"\"\n                  ref=\"realPicture\"\n                >\n                <span class=\"el-upload-list__item-actions\">\n                  <span\n                    v-if=\"!disabled\"\n                    class=\"el-upload-list__item-delete\"\n                    @click=\"handleRemove(file)\"\n                  >\n                    <i class=\"el-icon-delete\" />\n                  </span>\n                </span>\n              </div>\n            </el-upload>\n          </div>\n        </div>\n\n        <div class=\"mintNFTFrameMain_right\">\n          <div class=\"selectBox\">\n            <div class=\"select\">\n              <div class=\"tipsBox\">\n                <div class=\"tipsTitle\">\n                  Name (NFT系列名)\n                </div>\n                <div class=\"tipsTitle2\">\n                  <span style=\"font-size: 1.5vw;font-weight: 800;margin-top: 2%;\"> {{ seriesName }}</span>\n                </div>\n              </div>\n            </div>\n            <div class=\"select\">\n              <div class=\"tipsBox\">\n                <div class=\"tipsTitle\">\n                  Symbol (该系列NFT代币符号)\n                </div>\n                <div class=\"tipsTitle2\">\n                  <span style=\"font-size: 1.5vw;font-weight: 800;margin-top: 2%\">{{ symbol }}</span>\n                </div>\n              </div>\n            </div>\n            <div class=\"select\">\n              <div class=\"tipsBox\">\n                <div class=\"tipsTitle\">\n                  <span style=\"color: red\">*</span> Add NFT Name\n                </div>\n                <div class=\"tipsTitle2\">\n                  新增加的NFT名称\n                </div>\n              </div>\n              <el-input\n                v-model=\"NFTName\"\n                placeholder=\"Please enter the name of NFT\"\n              />\n            </div>\n            <div class=\"select\">\n              <div class=\"tipsBox\">\n                <div class=\"tipsTitle\">\n                  Description\n                </div>\n                <div class=\"tipsTitle2\">\n                  描述将包含在商品详情页面上图片下方 <span style=\"color: red\">(不能为关键字 '3D' )</span>  \n                </div>\n              </div>\n              <el-input\n                type=\"textarea\"\n                v-model=\"Description\"\n                placeholder=\"Please add a description\"\n              />\n            </div>\n            <div class=\"select\">\n              <div class=\"tipsBox\">\n                <div class=\"tipsTitle\">\n                  As a gift (optional)\n                </div>\n                <div class=\"tipsTitle2\">\n                  作为礼物赠送（可选）\n                </div>\n              </div>\n              <el-input\n                placeholder=\"请输入赠送者地址\"\n                v-model=\"to\"\n              >\n                <template slot=\"prepend\">\n                  <img\n                    width=\"25px\"\n                    height=\"25px\"\n                    src=\"@/assets/SVG/Love.svg\"\n                    alt=\"SVG Image\"\n                    style=\"color:\"\n                  >\n                </template>\n              </el-input>\n            </div>\n            <div class=\"select\">\n              <div class=\"sumbitBox\">\n                <el-button\n                  @click=\"addMint\"\n                  :disabled=\"!canSubmit\"\n                  class=\"createButton\"\n                >\n                  添加\n                </el-button>\n              </div>\n            </div>\n            <div class=\"select\">\n              <div class=\"sumbitBox\">\n                <router-link :to=\"{ name: 'addmint3D',query:{nftContract:nftContractAddress}}\">\n                  <el-button\n                    class=\"createButton\"\n                    style=\"margin-top: 3%;width: 100%;background-color: var(--White--);color: var(--Dark--);\"\n                  >\n                    To Add3DNFT <i\n                      class=\"\nel-icon-d-arrow-right\"\n                    />\n                  </el-button>\n                </router-link>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n  import { process } from \"@/utils/nsfwjs\";\n  import { getNFTStruct } from \"@/api/axios/contract\";\n  import { addMint } from \"@/api/axios/contract\";\n  export default {\n    data() {\n      return {\n        imageUrl: \"\",\n        dialogImageUrl: \"\",\n        dialogVisible: false,\n        disabled: false,\n        fileList: [],\n        seriesName: \"\",\n        symbol: \"\",\n        nftContractAddress: \"\",\n        Description: \"\",\n        maximums: 0,\n        NFTName: \"\",\n        to: this.$store.state.currentAddress,\n        sumitEnable: true,\n        isRepeatClick: true,\n\n        isProcess: false,\n        processLoading: false,\n        noProcess: false,\n        isChanging:false\n      };\n    },\n    async mounted() {\n      this.nftContractAddress = this.$route.query.nftContract;\n      await this.init();\n    },\n    computed: {\n      canSubmit() {\n        if (\n          this.seriesName == \"\" ||\n          this.symbol == \"\" ||\n          this.$refs.pictureUpload.uploadFiles.length == 0 ||\n          this.NFTName == \"\" ||\n          !this.isProcess ||\n          this.Description == '3D'\n        ) {\n          return false;\n        } else {\n          return true;\n        }\n      },\n  },\n  watch: {\n    Description(newData) {\n      if (newData == '3D') {\n        this.$notify({\n                title: \"不能为关键字\",\n                type: \"warning\",\n                position: \"top-left\",\n                offset: 200,\n              });\n        this.Description =''\n      }\n    }\n    },\n    methods: {\n      async setPicture() {\n        if (this.$refs.pictureUpload.uploadFiles.length == 1) {\n          this.processLoading = true;\n          setTimeout(async () => {\n            console.log(this.$refs.realPicture);\n            await process(this.$refs.realPicture).then((re) => {\n              this.processLoading = false;\n              if (\n                (re[0].className == \"Neutral\" && re[0].probability > 0.8) ||\n                (re[0].className == \"Drawing\" && re[0].probability > 0.8)\n              ) {\n                this.isProcess = true;\n              } else {\n                this.isProcess = false;\n                this.noProcess = true;\n              }\n            });\n          }, 500);\n        }\n      },\n      async init() {\n        let contract = await getNFTStruct(this.nftContractAddress);\n        await contract.methods\n          .symbol()\n          .call()\n          .then((re) => {\n            this.symbol = re;\n          });\n        await contract.methods\n          .name()\n          .call()\n          .then((re) => {\n            this.seriesName = re;\n          });\n        await contract.methods\n          ._maximums()\n          .call()\n          .then((re) => {\n            this.maximums = re;\n          });\n      },\n      async addMint() {\n        if (this.isRepeatClick) {\n          this.isRepeatClick = false;\n          if (\n            this.$refs.pictureUpload.uploadFiles[0].raw.type == \"image/jepg\" ||\n            this.$refs.pictureUpload.uploadFiles[0].raw.type == \"image/png\" ||\n            this.$refs.pictureUpload.uploadFiles[0].raw.type == \"image/jpg\"\n          ) {\n            try {\n              this.isChanging=true\n              await addMint(\n                this.to,\n                this.nftContractAddress,\n                this.NFTName,\n                this.Description,\n                this.$refs.pictureUpload.uploadFiles,\n                this.seriesName,\n                this.symbol,\n                this.maximums\n              );\n              this.isChanging=false\n              this.$notify({\n                title: \"添加成功\",\n                type: \"success\",\n                position: \"top-left\",\n                offset: 200,\n              });\n              this.fileList = [];\n              this.NFTName = \"\";\n              this.maximums = 1;\n              this.Description = \"\";\n            } catch (error) {\n              this.isChanging=false\n              this.$notify.error({\n                title: \"添加失败\",\n                position: \"top-left\",\n                offset: 200,\n              });\n            }\n          } else {\n            this.$notify({\n              title: \"NFT格式不支持\",\n              type: \"warning\",\n              position: \"top-left\",\n              offset: 200,\n            });\n          }\n        } else {\n          this.$notify({\n            title: \"请勿操作频繁\",\n            type: \"warning\",\n            position: \"top-left\",\n            offset: 200,\n          });\n        }\n\n        setTimeout(() => {\n          this.isRepeatClick = true;\n        }, 5000);\n      },\n      handleRemove(file) {\n        let uploadFiles = this.$refs.pictureUpload.uploadFiles;\n        for (var i = 0; i < uploadFiles.length; i++) {\n          if (uploadFiles[i][\"url\"] == file.url) {\n            uploadFiles.splice(i, 1);\n          }\n        }\n        this.isProcess = false;\n        this.noProcess = false;\n      },\n    },\n  };\n</script>\n\n<style lang=\"scss\" scoped>\n  @import \"@/styles/.scss\";\n</style>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}