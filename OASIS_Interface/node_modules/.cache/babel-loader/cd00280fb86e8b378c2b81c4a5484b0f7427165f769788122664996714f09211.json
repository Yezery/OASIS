{"ast":null,"code":"import { CodeError } from '@libp2p/interfaces/errors';\n// @ts-expect-error types are missing\nimport forgePbkdf2 from 'node-forge/lib/pbkdf2.js';\n// @ts-expect-error types are missing\nimport forgeUtil from 'node-forge/lib/util.js';\n/**\n * Maps an IPFS hash name to its node-forge equivalent.\n *\n * See https://github.com/multiformats/multihash/blob/master/hashtable.csv\n *\n * @private\n */\nconst hashName = {\n  sha1: 'sha1',\n  'sha2-256': 'sha256',\n  'sha2-512': 'sha512'\n};\n/**\n * Computes the Password-Based Key Derivation Function 2.\n */\nexport default function pbkdf2(password, salt, iterations, keySize, hash) {\n  if (hash !== 'sha1' && hash !== 'sha2-256' && hash !== 'sha2-512') {\n    const types = Object.keys(hashName).join(' / ');\n    throw new CodeError(`Hash '${hash}' is unknown or not supported. Must be ${types}`, 'ERR_UNSUPPORTED_HASH_TYPE');\n  }\n  const hasher = hashName[hash];\n  const dek = forgePbkdf2(password, salt, iterations, keySize, hasher);\n  return forgeUtil.encode64(dek, null);\n}","map":{"version":3,"names":["CodeError","forgePbkdf2","forgeUtil","hashName","sha1","pbkdf2","password","salt","iterations","keySize","hash","types","Object","keys","join","hasher","dek","encode64"],"sources":["../../src/pbkdf2.ts"],"sourcesContent":[null],"mappings":"AAAA,SAASA,SAAS,QAAQ,2BAA2B;AACrD;AACA,OAAOC,WAAW,MAAM,0BAA0B;AAClD;AACA,OAAOC,SAAS,MAAM,wBAAwB;AAE9C;;;;;;;AAOA,MAAMC,QAAQ,GAAG;EACfC,IAAI,EAAE,MAAM;EACZ,UAAU,EAAE,QAAQ;EACpB,UAAU,EAAE;CACb;AAED;;;AAGA,eAAc,SAAUC,MAAMA,CAAEC,QAAgB,EAAEC,IAAY,EAAEC,UAAkB,EAAEC,OAAe,EAAEC,IAAY;EAC/G,IAAIA,IAAI,KAAK,MAAM,IAAIA,IAAI,KAAK,UAAU,IAAIA,IAAI,KAAK,UAAU,EAAE;IACjE,MAAMC,KAAK,GAAGC,MAAM,CAACC,IAAI,CAACV,QAAQ,CAAC,CAACW,IAAI,CAAC,KAAK,CAAC;IAC/C,MAAM,IAAId,SAAS,CAAC,SAASU,IAAI,0CAA0CC,KAAK,EAAE,EAAE,2BAA2B,CAAC;;EAGlH,MAAMI,MAAM,GAAGZ,QAAQ,CAACO,IAAI,CAAC;EAC7B,MAAMM,GAAG,GAAGf,WAAW,CACrBK,QAAQ,EACRC,IAAI,EACJC,UAAU,EACVC,OAAO,EACPM,MAAM,CACP;EAED,OAAOb,SAAS,CAACe,QAAQ,CAACD,GAAG,EAAE,IAAI,CAAC;AACtC"},"metadata":{},"sourceType":"module","externalDependencies":[]}